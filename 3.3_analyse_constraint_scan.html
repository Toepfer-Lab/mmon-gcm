<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.557">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mmon-gcm - Analysing the results of the constraint scan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./functions/alternativemodes.html" rel="next">
<link href="./3.2_run_constraint_scan.html" rel="prev">
<link href="./favicon.svg" rel="icon" type="image/svg+xml">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="mmon-gcm - Analysing the results of the constraint scan">
<meta property="og:description" content="Repo for MMON-gcm">
<meta property="og:image" content="https://noahsprent.github.io/mmon-gcm/logo.svg">
<meta property="og:site_name" content="mmon-gcm">
<meta name="twitter:title" content="mmon-gcm - Analysing the results of the constraint scan">
<meta name="twitter:description" content="Repo for MMON-gcm">
<meta name="twitter:image" content="https://noahsprent.github.io/mmon-gcm/logo.svg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">mmon-gcm</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./3.1_generate_constraints_df.html">Running constraints scan</a></li><li class="breadcrumb-item"><a href="./3.3_analyse_constraint_scan.html">Analysing the results of the constraint scan</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MMON-GCM</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Building model and defining parameters</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.0_generating_linkers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generating table for linkers/osmolytes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.1_buildingmodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.2_defining_parameters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finding parameters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.3_atpase_constraint.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Is H+ATPase limiting?</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">1.4_flutschconcentrations.ipynb</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.5_convert_horrer_starch_level.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Starch amount estimation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Solving and analysing specific scenarios for paper</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.1_solvingmodel.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solving guard cell models for different parameters</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.2_analysingsolutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysing solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.3_flux_map_values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Calculating line widths for flux maps</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Running constraints scan</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.1_generate_constraints_df.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Constraint scan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.2_run_constraint_scan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Running Constraint Scan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.3_analyse_constraint_scan.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Analysing the results of the constraint scan</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Running and analysing alternative flux modes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
 <span class="menu-text">4.1_generate_alternative_flux_modes_matrix.ipynb</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">4.2_run_alternative_flux_modes.ipynb</span>
  </li>
          <li class="sidebar-item">
 <span class="menu-text">4.3_analyse_alternative_flux_modes.ipynb</span>
  </li>
      </ul>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">prep_plant_cell.ipynb</span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">functions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/alternativemodes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">alternativemodes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/analysing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/buildingediting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">buildingediting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/constraintscan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">constraintscan</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/helper.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Helper functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/osmolyteconstraints.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">osmolyteconstraints</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/solving.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">solving</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#importing-results-and-constraints" id="toc-importing-results-and-constraints" class="nav-link active" data-scroll-target="#importing-results-and-constraints">Importing results and constraints</a></li>
  <li><a href="#a---what-contributes-to-phloem-output" id="toc-a---what-contributes-to-phloem-output" class="nav-link" data-scroll-target="#a---what-contributes-to-phloem-output">7a - What contributes to phloem output?</a>
  <ul class="collapse">
  <li><a href="#set-up-features-for-linear-regression-by" id="toc-set-up-features-for-linear-regression-by" class="nav-link" data-scroll-target="#set-up-features-for-linear-regression-by">Set up features for linear regression by</a></li>
  <li><a href="#compare-full-and-gc-features" id="toc-compare-full-and-gc-features" class="nav-link" data-scroll-target="#compare-full-and-gc-features">Compare full and gc features</a></li>
  </ul></li>
  <li><a href="#b---what-affects-hexose-export-from-the-guard-cell" id="toc-b---what-affects-hexose-export-from-the-guard-cell" class="nav-link" data-scroll-target="#b---what-affects-hexose-export-from-the-guard-cell">7b - What affects hexose export from the guard cell?</a>
  <ul class="collapse">
  <li><a href="#generate-hexose-export-df" id="toc-generate-hexose-export-df" class="nav-link" data-scroll-target="#generate-hexose-export-df">Generate hexose export df</a></li>
  <li><a href="#fit-model-to-hexose-export" id="toc-fit-model-to-hexose-export" class="nav-link" data-scroll-target="#fit-model-to-hexose-export">Fit model to hexose export</a></li>
  <li><a href="#create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light" id="toc-create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light" class="nav-link" data-scroll-target="#create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light">Create a reponse for total photons into the GC, irrespective of blue or white light</a></li>
  <li><a href="#are-there-any-solutions-where-net-carbon-export-are-below-0" id="toc-are-there-any-solutions-where-net-carbon-export-are-below-0" class="nav-link" data-scroll-target="#are-there-any-solutions-where-net-carbon-export-are-below-0">Are there any solutions where net carbon export are below 0?</a></li>
  </ul></li>
  <li><a href="#at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink" id="toc-at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink" class="nav-link" data-scroll-target="#at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink">At our predicted level of osmolarity and other guard cell parameters, what would FqFm.R_ch need to be for guard cell to act as a sink?</a>
  <ul class="collapse">
  <li><a href="#what-is-the-range-of-photosynthetic-capacities-that-we-use" id="toc-what-is-the-range-of-photosynthetic-capacities-that-we-use" class="nav-link" data-scroll-target="#what-is-the-range-of-photosynthetic-capacities-that-we-use">What is the range of photosynthetic capacities that we use?</a></li>
  </ul></li>
  <li><a href="#c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much" id="toc-c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much" class="nav-link" data-scroll-target="#c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much">7c - So does the ATPase have an effect on starch if not on hexose export very much?</a>
  <ul class="collapse">
  <li><a href="#how-many-solutions-utilise-starch" id="toc-how-many-solutions-utilise-starch" class="nav-link" data-scroll-target="#how-many-solutions-utilise-starch">How many solutions utilise starch?</a></li>
  </ul></li>
  <li><a href="#in-how-many-of-those-solutions-is-the-atpase-constrained" id="toc-in-how-many-of-those-solutions-is-the-atpase-constrained" class="nav-link" data-scroll-target="#in-how-many-of-those-solutions-is-the-atpase-constrained">In how many of those solutions is the ATPase constrained?</a></li>
  <li><a href="#how-many-constrained-solutions-dont-use-starch" id="toc-how-many-constrained-solutions-dont-use-starch" class="nav-link" data-scroll-target="#how-many-constrained-solutions-dont-use-starch">How many constrained solutions don’t use starch?</a>
  <ul class="collapse">
  <li><a href="#how-do-starch-levels-vary-with-whiteblue-light" id="toc-how-do-starch-levels-vary-with-whiteblue-light" class="nav-link" data-scroll-target="#how-do-starch-levels-vary-with-whiteblue-light">How do starch levels vary with white/blue light?</a></li>
  </ul></li>
  <li><a href="#how-is-starch-used" id="toc-how-is-starch-used" class="nav-link" data-scroll-target="#how-is-starch-used">How is starch used?</a></li>
  <li><a href="#d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear" id="toc-d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear" class="nav-link" data-scroll-target="#d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear">7d - How does glucose increase during opening vary with starch, and why isn’t it totally linear?</a></li>
  <li><a href="#combine-subfigures" id="toc-combine-subfigures" class="nav-link" data-scroll-target="#combine-subfigures">Combine subfigures</a></li>
  <li><a href="#extra-analyses-not-included" id="toc-extra-analyses-not-included" class="nav-link" data-scroll-target="#extra-analyses-not-included">Extra analyses not included</a>
  <ul class="collapse">
  <li><a href="#what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase" id="toc-what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase" class="nav-link" data-scroll-target="#what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase">What is the ratio of mitochondrial to plastidic ATP synthase?</a></li>
  </ul></li>
  <li><a href="#almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs" id="toc-almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs" class="nav-link" data-scroll-target="#almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs">Almost all starch is used for glucose, and PEP carboxykinase reaction never runs</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/noahsprent/mmon-gcm/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./3.1_generate_constraints_df.html">Running constraints scan</a></li><li class="breadcrumb-item"><a href="./3.3_analyse_constraint_scan.html">Analysing the results of the constraint scan</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Analysing the results of the constraint scan</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div id="cafbaa7f-5201-4360-8b4f-2c447173afca" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cobra</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.cm <span class="im">import</span> ScalarMappable</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> Normalize</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> AutoMinorLocator, MultipleLocator</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.analysing <span class="im">import</span> get_phase_lengths</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.supermodel <span class="im">import</span> SuperModel</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, StandardScaler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7a609d8b-537a-41db-9030-6b293c96121f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"ticks"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>palettes <span class="op">=</span> {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tol_bright"</span>: sns.color_palette(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"#4477AA"</span>, <span class="st">"#66CCEE"</span>, <span class="st">"#228833"</span>, <span class="st">"#CCBB44"</span>, <span class="st">"#EE6677"</span>, <span class="st">"#AA3377"</span>, <span class="st">"#BBBBBB"</span>]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tol_muted"</span>: sns.color_palette(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#332288"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#88CCEE"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#44AA99"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#117733"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#999933"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#DDCC77"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#CC6677"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#882255"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#AA4499"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>sns.set_palette(palettes[<span class="st">"tol_muted"</span>])</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>colours <span class="op">=</span> sns.color_palette()</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"xtick.labelsize"</span>: <span class="st">"large"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ytick.labelsize"</span>: <span class="st">"large"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.labelsize"</span>: <span class="st">"large"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.titlesize"</span>: <span class="st">"x-large"</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"font.family"</span>: <span class="st">"sans-serif"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.spines.right"</span>: <span class="va">False</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.spines.top"</span>: <span class="va">False</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"legend.frameon"</span>: <span class="va">False</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"savefig.bbox"</span>: <span class="st">"tight"</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"lines.linewidth"</span>: <span class="fl">2.5</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"figure.figsize"</span>: [<span class="dv">5</span>, <span class="fl">3.75</span>],</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"figure.dpi"</span>: <span class="dv">150</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fd2fd712-9d6f-407f-8f98-b0470ed39209" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_bounds_in_model(constraints):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    super_model <span class="op">=</span> SuperModel(constraints)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    volumes <span class="op">=</span> super_model.get_volumes(per_guard_cell<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    closed_volume <span class="op">=</span> volumes[<span class="dv">0</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    open_volume <span class="op">=</span> volumes[<span class="dv">1</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    osmolarities <span class="op">=</span> super_model.get_osmolarities()</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    closed_osmolarity <span class="op">=</span> osmolarities[<span class="dv">0</span>]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    open_osmolarity <span class="op">=</span> osmolarities[<span class="dv">1</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    photons <span class="op">=</span> super_model.get_photons(<span class="dv">150</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    gc_photons <span class="op">=</span> photons[<span class="dv">0</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    gc_atpase_upper_bound <span class="op">=</span> super_model.get_atpase_constraint_value(</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        constraints.loc[<span class="st">"ATPase"</span>]</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"V_closed"</span>: closed_volume,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">"V_open"</span>: open_volume,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Os_closed"</span>: closed_osmolarity,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Os_open"</span>: open_osmolarity,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Photons"</span>: gc_photons,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"ATPase"</span>: gc_atpase_upper_bound,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="importing-results-and-constraints" class="level2">
<h2 class="anchored" data-anchor-id="importing-results-and-constraints">Importing results and constraints</h2>
<div id="32bc7c60-390a-42f6-991c-8d3c73306b5c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import results files</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>blue_results <span class="op">=</span> pd.read_csv(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../outputs/constraint_scan/constraint_scan_results_blue.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>white_results <span class="op">=</span> pd.read_csv(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../outputs/constraint_scan/constraint_scan_results_white.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>scan_results <span class="op">=</span> pd.concat([white_results, blue_results])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>scan_results <span class="op">=</span> scan_results.reset_index().drop(<span class="st">"index"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># remove solutions which were not feasible</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>infeasible_solutions <span class="op">=</span> scan_results[scan_results.isna().<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>feasible_solutions <span class="op">=</span> scan_results.dropna()</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>scan_results <span class="op">=</span> feasible_solutions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7a5b6c3f" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(infeasible_solutions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>2</code></pre>
</div>
</div>
<div id="b8e683a2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(feasible_solutions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>1934</code></pre>
</div>
</div>
<div id="e20e46ca" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>scan_results.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(1934, 7101)</code></pre>
</div>
</div>
<div id="d05c2b8a-48dd-4ab8-ba36-3770933656e0" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert any fluxes that are below 10^-6 to 0</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>scan_results <span class="op">=</span> scan_results.mask(<span class="bu">abs</span>(scan_results) <span class="op">&lt;</span> <span class="fl">0.000001</span>, other<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="be10863c-47ec-4462-bd4e-e84552cbf199" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import constraints files</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>white_constraints <span class="op">=</span> pd.read_csv(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../outputs/constraint_scan/constraints_df.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>white_constraints[<span class="st">"light"</span>] <span class="op">=</span> <span class="st">"white"</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>blue_constraints <span class="op">=</span> pd.read_csv(</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../outputs/constraint_scan/constraints_df.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>blue_constraints[<span class="st">"light"</span>] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>scan_constraints <span class="op">=</span> pd.concat([white_constraints, blue_constraints])</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>scan_constraints <span class="op">=</span> scan_constraints.reset_index().drop(<span class="st">"index"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># remove infeasible constraints combinations</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>feasible_scan_constraints <span class="op">=</span> scan_constraints.loc[feasible_solutions.index]</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>infeasible_scan_constraints <span class="op">=</span> scan_constraints.loc[infeasible_solutions.index]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>scan_constraints <span class="op">=</span> feasible_scan_constraints</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove maintenance in scan_constraints</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co">#scan_constraints = scan_constraints.drop('Maintenance', axis=1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c29d52ad" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>scan_constraints.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Index(['P_abs', 'T_l', 'A_l', 'V_gc_ind', 'FqFm', 'R_ch', 'R_ch_vol', 'L_air',
       'L_epidermis', 'Vac_frac', 'T', 'R', 'N_gcs', 'n', 'm', 'r', 's',
       'C_apo', 'A_closed', 'A_open', 'ATPase', 'light'],
      dtype='object')</code></pre>
</div>
</div>
<div id="d32e407b-e850-429c-a180-0963875569f6" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import constraints that were used in previous paper solutions</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>default_constraints <span class="op">=</span> pd.read_csv(<span class="st">"../inputs/arabidopsis_parameters.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)[</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Value"</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>paper_constraints <span class="op">=</span> []</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> []</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"white"</span>, <span class="st">"blue"</span>, <span class="st">"nops"</span>]:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> constraint <span class="kw">in</span> [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>]:</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        constraints <span class="op">=</span> default_constraints.copy()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> constraint <span class="op">==</span> <span class="st">"unconstrained"</span>:</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>            constraints[<span class="st">"ATPase"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> constraint <span class="op">==</span> <span class="st">"constrained"</span>:</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>            constraints[<span class="st">"ATPase"</span>] <span class="op">=</span> <span class="fl">7.48</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        constraints[<span class="st">"light"</span>] <span class="op">=</span> light</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        index.append(<span class="ss">f"</span><span class="sc">{</span>light<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>constraint<span class="sc">}</span><span class="ss">_wt"</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        paper_constraints.append(constraints)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>paper_constraints <span class="op">=</span> pd.DataFrame(paper_constraints, index<span class="op">=</span>index)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>paper_constraints <span class="op">=</span> paper_constraints.iloc[<span class="dv">1</span>, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>paper_constraints</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>P_abs                  0.9
T_l                0.00017
A_l                    1.0
V_gc_ind               0.0
FqFm                   0.9
R_ch              0.069231
R_ch_vol          0.200476
L_air                 0.37
L_epidermis           0.15
Vac_frac             0.751
T                   296.15
R                  0.08205
N_gcs          580000000.0
n                      2.5
m                      0.8
r                      0.0
s                      0.0
C_apo              0.02302
A_closed               1.6
A_open                2.75
ATPase                7.48
Name: white_constrained_wt, dtype: object</code></pre>
</div>
</div>
<div id="85880081-d8f8-4e93-b537-8f7460f0e85d" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import results for previous simulations in paper</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>paper_solution_files <span class="op">=</span> []</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"white"</span>, <span class="st">"blue"</span>, <span class="st">"nops"</span>]:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> constraint <span class="kw">in</span> [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>]:</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        paper_solution_files.append(<span class="ss">f"</span><span class="sc">{</span>light<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>constraint<span class="sc">}</span><span class="ss">_wt.csv"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>solution_dfs <span class="op">=</span> [</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    pd.read_csv(<span class="ss">f"../outputs/model_solutions/</span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">"</span>, index_col<span class="op">=</span><span class="dv">0</span>)[<span class="st">"fluxes"</span>]</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> file_name <span class="kw">in</span> paper_solution_files</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>paper_results <span class="op">=</span> pd.concat(solution_dfs, axis<span class="op">=</span><span class="dv">1</span>).T</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>paper_results.index <span class="op">=</span> index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="acddb344-eee9-4a08-987e-abb5bad338f1" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get a reduced get of constraints that are more specific to the guard cell</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints <span class="op">=</span> pd.DataFrame.from_dict(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">list</span>(scan_constraints.<span class="bu">apply</span>(get_bounds_in_model, axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints[<span class="st">"Os_dif"</span>] <span class="op">=</span> (</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    scan_gc_constraints[<span class="st">"Os_open"</span>] <span class="op">-</span> scan_gc_constraints[<span class="st">"Os_closed"</span>]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints.index <span class="op">=</span> scan_constraints.index</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/maurice/Sync/GC/mmon-gcm/mmon_gcm/supermodel.py:23: UserWarning: No fba model added to the Supermodel, fine if that's what you want
  warnings.warn("No fba model added to the Supermodel, fine if that's what you want")</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">V_closed</th>
<th data-quarto-table-cell-role="th">V_open</th>
<th data-quarto-table-cell-role="th">Os_closed</th>
<th data-quarto-table-cell-role="th">Os_open</th>
<th data-quarto-table-cell-role="th">Photons</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">Os_dif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.000157</td>
<td>0.000476</td>
<td>0.033212</td>
<td>0.278138</td>
<td>0.107908</td>
<td>0.004851</td>
<td>0.244926</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.000321</td>
<td>0.000738</td>
<td>0.067499</td>
<td>0.370715</td>
<td>0.106820</td>
<td>0.000585</td>
<td>0.303216</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.000248</td>
<td>0.000268</td>
<td>0.059662</td>
<td>0.070491</td>
<td>0.031490</td>
<td>0.004505</td>
<td>0.010828</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.000134</td>
<td>0.000278</td>
<td>0.033181</td>
<td>0.140030</td>
<td>0.013079</td>
<td>0.004855</td>
<td>0.106849</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.000438</td>
<td>0.000786</td>
<td>0.107888</td>
<td>0.313097</td>
<td>0.034626</td>
<td>0.011479</td>
<td>0.205209</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="221764d1-f8f9-44c1-9d66-857c2f4837ed" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>paper_gc_constraints <span class="op">=</span> pd.Series(get_bounds_in_model(paper_constraints))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>paper_gc_constraints[<span class="st">"Os_dif"</span>] <span class="op">=</span> (</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    paper_gc_constraints[<span class="st">"Os_open"</span>] <span class="op">-</span> paper_gc_constraints[<span class="st">"Os_closed"</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>paper_gc_constraints</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/maurice/Sync/GC/mmon-gcm/mmon_gcm/supermodel.py:23: UserWarning: No fba model added to the Supermodel, fine if that's what you want
  warnings.warn("No fba model added to the Supermodel, fine if that's what you want")</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>V_closed     0.000220
V_open       0.000254
Os_closed    0.039359
Os_open      0.054922
Photons      0.018372
ATPase       0.004338
Os_dif       0.015563
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="a---what-contributes-to-phloem-output" class="level2">
<h2 class="anchored" data-anchor-id="a---what-contributes-to-phloem-output">7a - What contributes to phloem output?</h2>
<section id="set-up-features-for-linear-regression-by" class="level3">
<h3 class="anchored" data-anchor-id="set-up-features-for-linear-regression-by">Set up features for linear regression by</h3>
<section id="convert-light-using-onehotencoder" class="level4">
<h4 class="anchored" data-anchor-id="convert-light-using-onehotencoder">Convert light using onehotencoder</h4>
<div id="a35be9f1" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>scan_constraints[[<span class="st">"light"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">light</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1931</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1932</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1933</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1934</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1935</td>
<td>blue</td>
</tr>
</tbody>
</table>

<p>1934 rows × 1 columns</p>
</div>
</div>
</div>
<div id="2e5c7e03-7253-442e-b948-745bc5a21327" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the subject column as a pandas DataFrame</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>light <span class="op">=</span> scan_constraints[[<span class="st">"light"</span>]]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># setting sparse=False means that enc.transform() will return an array</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>enc <span class="op">=</span> OneHotEncoder(sparse_output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the encoder to the data</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>enc.fit(light)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># encode the data</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>light_enc <span class="op">=</span> enc.transform(light)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>light_columns <span class="op">=</span> pd.DataFrame(light_enc, columns<span class="op">=</span><span class="st">"light_"</span> <span class="op">+</span> enc.categories_[<span class="dv">0</span>], index<span class="op">=</span>scan_constraints.index) <span class="co"># Added index=scan_constraints.index </span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>full_features <span class="op">=</span> scan_constraints.drop(<span class="st">"light"</span>, axis<span class="op">=</span><span class="dv">1</span>).join(light_columns)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>gc_features <span class="op">=</span> scan_gc_constraints.join(light_columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="also-create-scaled-versions-of-features" class="level4">
<h4 class="anchored" data-anchor-id="also-create-scaled-versions-of-features">Also create scaled versions of features</h4>
<div id="2b817231-28ed-4277-9892-8ea0fa5d625e" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>scaler.fit(full_features)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>full_features_scaled <span class="op">=</span> scaler.transform(full_features)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>scaler.fit(gc_features)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>gc_features_scaled <span class="op">=</span> scaler.transform(gc_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8a04cd37" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>full_features[full_features.isna().<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">P_abs</th>
<th data-quarto-table-cell-role="th">T_l</th>
<th data-quarto-table-cell-role="th">A_l</th>
<th data-quarto-table-cell-role="th">V_gc_ind</th>
<th data-quarto-table-cell-role="th">FqFm</th>
<th data-quarto-table-cell-role="th">R_ch</th>
<th data-quarto-table-cell-role="th">R_ch_vol</th>
<th data-quarto-table-cell-role="th">L_air</th>
<th data-quarto-table-cell-role="th">L_epidermis</th>
<th data-quarto-table-cell-role="th">Vac_frac</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">m</th>
<th data-quarto-table-cell-role="th">r</th>
<th data-quarto-table-cell-role="th">s</th>
<th data-quarto-table-cell-role="th">C_apo</th>
<th data-quarto-table-cell-role="th">A_closed</th>
<th data-quarto-table-cell-role="th">A_open</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">light_blue</th>
<th data-quarto-table-cell-role="th">light_white</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

<p>0 rows × 23 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="compare-full-and-gc-features" class="level3">
<h3 class="anchored" data-anchor-id="compare-full-and-gc-features">Compare full and gc features</h3>
<div id="f442a04b-f31a-4dfd-bc3d-f6bdc3ba2c75" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> scan_results.Phloem_tx_overall</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#response = scan_results.Photon_tx_gc_3</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>lm_full <span class="op">=</span> LinearRegression()</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>lm_full.fit(full_features, response)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>full_pred <span class="op">=</span> lm_full.predict(full_features)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.5f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, full_pred))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.5f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, full_pred))</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>lm_gc <span class="op">=</span> LinearRegression()</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>lm_gc.fit(gc_features, response)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>gc_pred <span class="op">=</span> lm_gc.predict(gc_features)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.5f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, gc_pred))</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.5f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, gc_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.00040
Coefficient of determination, r2 = 0.99960
Mean squared error, MSE = 0.87829
Coefficient of determination, r2 = 0.12388</code></pre>
</div>
</div>
<p>So can’t predict phloem output using GC features, but can predict pretty well using the full set</p>
<section id="which-features-are-most-important" class="level4">
<h4 class="anchored" data-anchor-id="which-features-are-most-important">Which features are most important?</h4>
<div id="a4e0cc2b-fdd8-40e9-b06d-2da284154529" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_full.coef_, index<span class="op">=</span>full_features.columns).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">T_l</td>
<td>-4.514050e-01</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">light_blue</td>
<td>-3.533915e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">C_apo</td>
<td>-1.320172e-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">m</td>
<td>-8.770751e-04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Vac_frac</td>
<td>-7.229537e-04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">A_open</td>
<td>-2.302990e-04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">FqFm</td>
<td>-6.018903e-05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">n</td>
<td>-5.320860e-05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">V_gc_ind</td>
<td>-9.982424e-10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">r</td>
<td>-6.477489e-12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">N_gcs</td>
<td>-1.186773e-12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">A_l</td>
<td>-2.997951e-13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">R</td>
<td>-1.131064e-13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">s</td>
<td>1.957373e-11</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">T</td>
<td>4.679942e-06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">ATPase</td>
<td>4.859983e-06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">A_closed</td>
<td>1.710221e-04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">L_epidermis</td>
<td>2.027958e-04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">L_air</td>
<td>2.972018e-04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">R_ch_vol</td>
<td>4.995322e-04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">R_ch</td>
<td>1.383114e-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">light_white</td>
<td>3.533915e-01</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">P_abs</td>
<td>1.800514e+01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Lots of unimportant features so we can use lasso regression to see which ones we really need</p>
</section>
<section id="try-different-alphas-for-lasso-to-see-r2" class="level4">
<h4 class="anchored" data-anchor-id="try-different-alphas-for-lasso-to-see-r2">Try different alphas for lasso to see r2</h4>
<div id="592c0615-d32f-4d4e-b183-5a2f51e22232" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>r2s <span class="op">=</span> []</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span>alpha)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    lasso.fit(full_features, response)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    lasso_pred <span class="op">=</span> lasso.predict(full_features)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    r2s.append(r2_score(response, lasso_pred))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>pd.Series(r2s, index<span class="op">=</span>alphas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0.01    0.962288
0.02    0.850360
0.03    0.663812
0.04    0.402646
0.05    0.116440
0.06    0.111850
0.07    0.106593
0.08    0.100528
0.09    0.093654
0.10    0.085972
dtype: float64</code></pre>
</div>
</div>
<div id="cbe95701-e836-4ce4-80f0-c6c2e30ba1cf" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.linspace(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="dv">10</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>r2s <span class="op">=</span> []</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span>alpha)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    lasso.fit(full_features, response)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    lasso_pred <span class="op">=</span> lasso.predict(full_features)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    r2s.append(r2_score(response, lasso_pred))</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>pd.Series(r2s, index<span class="op">=</span>alphas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>0.001    0.999224
0.002    0.998105
0.003    0.996240
0.004    0.993628
0.005    0.990270
0.006    0.986166
0.007    0.981316
0.008    0.975719
0.009    0.969377
0.010    0.962288
dtype: float64</code></pre>
</div>
</div>
<p>Lets take 0.03 as it’s highest that rounds to 0.999</p>
</section>
<section id="lasso-with-alpha-0.003" class="level4">
<h4 class="anchored" data-anchor-id="lasso-with-alpha-0.003">Lasso with alpha = 0.003</h4>
<div id="a3943509-9489-4935-b27a-a41c94c80f42" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span><span class="fl">0.003</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>lasso.fit(full_features, response)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>lasso_pred <span class="op">=</span> lasso.predict(full_features)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>lass_coefs <span class="op">=</span> pd.DataFrame(lasso.coef_, index<span class="op">=</span>full_features.columns).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display coefficients that aren't 0</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>lass_coefs[<span class="bu">abs</span>(lass_coefs.loc[:, <span class="dv">0</span>]) <span class="op">&gt;</span> <span class="fl">0.00001</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">light_blue</td>
<td>-0.694783</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">T</td>
<td>-0.000436</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">A_open</td>
<td>-0.000309</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">P_abs</td>
<td>16.894629</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>P_abs and light are by far the largest coefficients</p>
</section>
<section id="try-scaled-as-well" class="level4">
<h4 class="anchored" data-anchor-id="try-scaled-as-well">Try scaled as well</h4>
<div id="be537cef-bf0d-4c5b-8759-4076448a5d9b" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>r2s <span class="op">=</span> []</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span>alpha)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    lasso.fit(full_features_scaled, response)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    lasso_pred <span class="op">=</span> lasso.predict(full_features_scaled)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    r2s.append(r2_score(response, lasso_pred))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>pd.Series(r2s, index<span class="op">=</span>alphas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0.01    0.999398
0.02    0.998799
0.03    0.997801
0.04    0.996405
0.05    0.994609
0.06    0.992415
0.07    0.989821
0.08    0.986829
0.09    0.983437
0.10    0.979646
dtype: float64</code></pre>
</div>
</div>
<div id="b07b47c3-8726-43a3-a261-9de3b0aee9c0" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>lasso.fit(full_features_scaled, response)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>lasso_pred <span class="op">=</span> lasso.predict(full_features_scaled)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>lass_coefs <span class="op">=</span> pd.DataFrame(lasso.coef_, index<span class="op">=</span>full_features.columns).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"r2 score: </span><span class="sc">{</span>r2_score(response, lasso_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># display coefficients that aren't 0</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>lass_coefs[<span class="bu">abs</span>(lass_coefs.loc[:, <span class="dv">0</span>]) <span class="op">&gt;</span> <span class="fl">0.00001</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>r2 score: 0.9993975321339854</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">light_blue</td>
<td>-0.343392</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">P_abs</td>
<td>0.926581</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>When scaled this is even clearer</p>
<div id="c7c59369-049b-413b-a148-f1c7238e3edc" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> phloemoutput_subfig(ax):</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> light, colour <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>        [<span class="st">"white"</span>, <span class="st">"blue"</span>], [sns.color_palette()[<span class="dv">1</span>], sns.color_palette()[<span class="dv">0</span>]]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        constraints_light_df <span class="op">=</span> scan_constraints[scan_constraints.light <span class="op">==</span> light]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        results_light_df <span class="op">=</span> scan_results[scan_constraints.light <span class="op">==</span> light]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        ax.scatter(</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>            constraints_light_df.P_abs,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>            results_light_df.Phloem_tx_overall,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span>light.capitalize(),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>colour,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    ax.legend(title<span class="op">=</span><span class="st">"Light during opening"</span>, loc<span class="op">=</span><span class="st">"upper left"</span>)  <span class="co"># Set loc to "upper left"</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"$P_</span><span class="sc">{abs}</span><span class="st">$</span><span class="ch">\n</span><span class="st">(Prop. photons absorbed by leaf)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Phloem output</span><span class="ch">\n</span><span class="st">(mmol$\cdot$m$^{-2}$leaf$\cdot$h$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="fl">11.9</span>, <span class="dv">17</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="fl">0.797</span>, <span class="dv">1</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"left"</span>].set_bounds(<span class="dv">12</span>, <span class="dv">17</span>)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"bottom"</span>].set_bounds(<span class="fl">0.8</span>, <span class="dv">1</span>)</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(<span class="fl">0.1</span>))</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.xaxis.set_minor_locator(AutoMinorLocator(2))</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(<span class="dv">1</span>))</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.yaxis.set_minor_locator(AutoMinorLocator(2))</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="bu">abs</span>(<span class="dv">1</span> <span class="op">-</span> <span class="fl">0.8</span>) <span class="op">/</span> <span class="bu">abs</span>(<span class="dv">17</span> <span class="op">-</span> <span class="dv">12</span>))</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>phloemoutput_subfig(ax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="b---what-affects-hexose-export-from-the-guard-cell" class="level2">
<h2 class="anchored" data-anchor-id="b---what-affects-hexose-export-from-the-guard-cell">7b - What affects hexose export from the guard cell?</h2>
<section id="generate-hexose-export-df" class="level3">
<h3 class="anchored" data-anchor-id="generate-hexose-export-df">Generate hexose export df</h3>
<div id="a17834f6-b5a5-4e41-9462-40ec1fda7eeb" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>four_stage_GC_model <span class="op">=</span> cobra.io.sbml.read_sbml_model(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../models/4_stage_GC.xml"</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># read model</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get total flux across all phases</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>net_carbon_dict <span class="op">=</span> {}</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metabolite <span class="kw">in</span> [<span class="st">"GLC"</span>, <span class="st">"FRU"</span>, <span class="st">"SUCROSE"</span>]:</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    net_metabolite <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, phase_length <span class="kw">in</span> <span class="bu">enumerate</span>(get_phase_lengths(four_stage_GC_model)):</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>        phase_number <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>        net_metabolite <span class="op">=</span> (</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>            net_metabolite</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> scan_results.loc[:, <span class="ss">f"</span><span class="sc">{</span>metabolite<span class="sc">}</span><span class="ss">_ae_gc_</span><span class="sc">{</span>phase_number<span class="sc">}</span><span class="ss">"</span>] <span class="op">*</span> phase_length</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    net_carbon_dict[metabolite] <span class="op">=</span> net_metabolite</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>net_carbon_df <span class="op">=</span> pd.DataFrame.from_dict(net_carbon_dict)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co"># correct for fact that sucrose is two hexoses</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>net_carbon <span class="op">=</span> (</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    net_carbon_df.GLC <span class="op">+</span> net_carbon_df.FRU <span class="op">+</span> net_carbon_df.SUCROSE <span class="op">*</span> <span class="dv">2</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>) <span class="op">*</span> <span class="op">-</span><span class="dv">1</span>  <span class="co"># mmol.m2-1</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>net_carbon <span class="op">=</span> net_carbon <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span>  <span class="co"># moles.m2-1</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>carbon_per_gc <span class="op">=</span> net_carbon <span class="op">/</span> scan_constraints.N_gcs  <span class="co"># moles.gc-1</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>carbon_per_gc <span class="op">=</span> carbon_per_gc <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span>  <span class="co"># fmol.gc-1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No objective coefficients in model. Unclear what should be optimized</code></pre>
</div>
</div>
</section>
<section id="fit-model-to-hexose-export" class="level3">
<h3 class="anchored" data-anchor-id="fit-model-to-hexose-export">Fit model to hexose export</h3>
<div id="45be4c1c-51ce-496d-b0bd-c70e27fd6f2b" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> carbon_per_gc</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> features <span class="kw">in</span> [full_features, gc_features]:</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    lm_1.fit(features, response)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 392.25
Coefficient of determination, r2 = 0.45
Mean squared error, MSE = 118.22
Coefficient of determination, r2 = 0.83</code></pre>
</div>
</div>
<p>So hexose export can be better predicted using the gc features compared to all the features. Is this because it’s hexose per gc?</p>
<div id="0efdd603-ffe0-48e7-94df-7617cbf61c18" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> features <span class="kw">in</span> [full_features, gc_features]:</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    lm_1.fit(features, response)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.00
Coefficient of determination, r2 = 0.52
Mean squared error, MSE = 0.00
Coefficient of determination, r2 = 1.00</code></pre>
</div>
</div>
<p>Seems so, as we’re confusing things by introducing the N_gcs division into the response</p>
<div id="b3f22883-3a81-4982-af04-a56ce9271151" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>lm_1.fit(gc_features, response)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(gc_features)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>lm_coefs <span class="op">=</span> pd.DataFrame(lm_1.coef_, index<span class="op">=</span>gc_features.columns).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>lm_coefs[<span class="bu">abs</span>(lm_coefs.loc[:, <span class="dv">0</span>]) <span class="op">&gt;</span> <span class="fl">0.00001</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">light_blue</td>
<td>-1.381741e+08</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">light_white</td>
<td>-1.381741e+08</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Os_open</td>
<td>-8.054295e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">V_closed</td>
<td>-1.611919e-02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ATPase</td>
<td>1.462491e-04</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Photons</td>
<td>2.354302e-04</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">V_open</td>
<td>6.360736e-03</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Os_dif</td>
<td>8.054295e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Os_closed</td>
<td>8.054295e+05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Mainly different light colours as well as osmolarity. What if we correct for light colour?</p>
</section>
<section id="create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light" class="level3">
<h3 class="anchored" data-anchor-id="create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light">Create a reponse for total photons into the GC, irrespective of blue or white light</h3>
<div id="225edf3a-13d2-44ca-a0ac-046b9fa1133a" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>photon_influx <span class="op">=</span> scan_results.loc[:, <span class="st">"Photon_tx_gc_3"</span>]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>photon_hours <span class="op">=</span> scan_constraints.loc[:, <span class="st">"light"</span>].<span class="bu">apply</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> x: <span class="dv">12</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">"white"</span> <span class="cf">else</span> <span class="fl">11.5</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>total_photons_per_day <span class="op">=</span> photon_influx <span class="op">*</span> photon_hours</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b965d465-d9d7-45bf-961f-1c9bd7b1cd92" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> np.array([total_photons_per_day]).T</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>lm_1.fit(features, response)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_1.coef_, index<span class="op">=</span>[<span class="st">"Photons per day"</span>]).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.000000
Coefficient of determination, r2 = 0.952128</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Photons per day</td>
<td>0.000019</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="8a23e3a3-a6a7-4200-91e4-f6e0923d7061" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> np.array([total_photons_per_day, gc_features.Os_dif]).T</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>lm_1.fit(features, response)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_1.coef_, index<span class="op">=</span>[<span class="st">"Photons per day"</span>, <span class="st">"Os dif"</span>]).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.000000
Coefficient of determination, r2 = 0.997839</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Os dif</td>
<td>-0.000042</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Photons per day</td>
<td>0.000020</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Pretty good R2</p>
<div id="3e52d168-d10b-4a45-9762-2e9a7ad17dde" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> np.array(gc_features.ATPase).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>lm_1.fit(features, response)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_1.coef_, index<span class="op">=</span>[<span class="st">"ATPase"</span>]).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.000000
Coefficient of determination, r2 = 0.109253</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">ATPase</td>
<td>0.001702</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>ATPase can’t really predict hexose export, at least not by itself</p>
<div id="4f705a56-d258-4b05-adbd-cbff571a3680" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> photons_vs_carbon_export_subfig(ax):</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>    max_os_dif <span class="op">=</span> scan_gc_constraints.Os_dif.<span class="bu">max</span>().<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    norm <span class="op">=</span> Normalize(vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span>max_os_dif)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    mappable <span class="op">=</span> ScalarMappable(norm<span class="op">=</span>norm, cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    net_carbon_mmol <span class="op">=</span> net_carbon <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">3</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    ax.scatter(</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>        total_photons_per_day,</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>        net_carbon_mmol,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>        c<span class="op">=</span>scan_gc_constraints.Os_dif,</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>        norm<span class="op">=</span>norm,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>        s<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    cbaxes <span class="op">=</span> ax.inset_axes([<span class="fl">0.1</span>, <span class="fl">0.93</span>, <span class="fl">0.40</span>, <span class="fl">0.05</span>])</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    cbar <span class="op">=</span> plt.colorbar(</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>        mappable, cax<span class="op">=</span>cbaxes, ticks<span class="op">=</span>[<span class="dv">0</span>, max_os_dif], orientation<span class="op">=</span><span class="st">"horizontal"</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    cbar.set_label(<span class="st">"Osmolarity increase</span><span class="ch">\n</span><span class="st">(mmol$\cdot$m$^{-2}\cdot$d$^{-1}$)"</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    inset_ax <span class="op">=</span> ax.inset_axes([<span class="fl">0.7</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>])</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    inset_ax.scatter(</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>        total_photons_per_day,</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>        net_carbon_mmol,</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>        c<span class="op">=</span>scan_gc_constraints.Os_dif,</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>        s<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>    inset_ax.set_xlim([<span class="op">-</span><span class="fl">0.3</span> <span class="op">/</span> <span class="dv">10</span>, <span class="dv">2</span>])</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    inset_ax.set_ylim([<span class="op">-</span><span class="fl">0.02</span> <span class="op">/</span> <span class="dv">5</span>, <span class="fl">0.04</span>])</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    inset_ax.tick_params(labelsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    inset_ax.spines[<span class="st">"left"</span>].set_bounds(<span class="dv">0</span>, <span class="fl">0.04</span>)</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    inset_ax.spines[<span class="st">"bottom"</span>].set_bounds(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>    inset_ax.yaxis.set_major_locator(MultipleLocator(<span class="fl">0.04</span>))</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>    inset_ax.yaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>    inset_ax.xaxis.set_major_locator(MultipleLocator(<span class="dv">2</span>))</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>    inset_ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim([<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">10</span>])</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim([<span class="op">-</span><span class="fl">0.02</span>, <span class="fl">0.15</span>])</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"left"</span>].set_bounds(<span class="dv">0</span>, <span class="fl">0.15</span>)</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"bottom"</span>].set_bounds(<span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(<span class="dv">2</span>))</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(<span class="fl">0.05</span>))</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="bu">abs</span>(<span class="dv">10</span> <span class="op">-</span> <span class="dv">0</span>) <span class="op">/</span> <span class="bu">abs</span>(<span class="fl">0.15</span> <span class="op">-</span> <span class="dv">0</span>))</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Photons per day into GC</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="vs">r"(mmol$\cdot$m$^{-2}\cdot$d$^{-1}$)"</span>,</span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="st">"medium"</span>,</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Net hexose export flux from GC</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="vs">r"(mmol$\cdot$m$^{-2}\cdot$h$^{-1}$)"</span>,</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>        size<span class="op">=</span><span class="st">"medium"</span>,</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>photons_vs_carbon_export_subfig(ax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="are-there-any-solutions-where-net-carbon-export-are-below-0" class="level3">
<h3 class="anchored" data-anchor-id="are-there-any-solutions-where-net-carbon-export-are-below-0">Are there any solutions where net carbon export are below 0?</h3>
<div id="3db88bd5-50eb-466c-b14d-d0ed29ee4e17" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>(net_carbon <span class="op">&lt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>177</code></pre>
</div>
</div>
<div id="feee3548" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(net_carbon <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>1757</code></pre>
</div>
</div>
<div id="67b3fe33" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(net_carbon <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>0</code></pre>
</div>
</div>
<div id="95da4ccb" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-</span>((net_carbon <span class="op">&lt;</span> <span class="dv">0</span>).<span class="bu">sum</span>())<span class="op">/</span><span class="bu">len</span>(net_carbon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>0.9084798345398138</code></pre>
</div>
</div>
<p>What’s interesting about them?</p>
<div id="15f30a93-347b-4569-b52a-0a2c1ed2aa88" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>scan_constraints.loc[net_carbon <span class="op">&lt;</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">P_abs</th>
<th data-quarto-table-cell-role="th">T_l</th>
<th data-quarto-table-cell-role="th">A_l</th>
<th data-quarto-table-cell-role="th">V_gc_ind</th>
<th data-quarto-table-cell-role="th">FqFm</th>
<th data-quarto-table-cell-role="th">R_ch</th>
<th data-quarto-table-cell-role="th">R_ch_vol</th>
<th data-quarto-table-cell-role="th">L_air</th>
<th data-quarto-table-cell-role="th">L_epidermis</th>
<th data-quarto-table-cell-role="th">Vac_frac</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">N_gcs</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">m</th>
<th data-quarto-table-cell-role="th">r</th>
<th data-quarto-table-cell-role="th">s</th>
<th data-quarto-table-cell-role="th">C_apo</th>
<th data-quarto-table-cell-role="th">A_closed</th>
<th data-quarto-table-cell-role="th">A_open</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">light</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0.880998</td>
<td>0.000192</td>
<td>1.0</td>
<td>8.629192e-13</td>
<td>0.866582</td>
<td>0.051244</td>
<td>0.204472</td>
<td>0.309538</td>
<td>0.169957</td>
<td>0.813726</td>
<td>...</td>
<td>3.851195e+08</td>
<td>2.077401</td>
<td>0.940848</td>
<td>5.747590e-14</td>
<td>1.515328e-13</td>
<td>0.029770</td>
<td>3.399462</td>
<td>9.936390</td>
<td>12.606738</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>0.977490</td>
<td>0.000213</td>
<td>1.0</td>
<td>8.097892e-13</td>
<td>0.849340</td>
<td>0.085944</td>
<td>0.200220</td>
<td>0.228127</td>
<td>0.106448</td>
<td>0.830654</td>
<td>...</td>
<td>6.380687e+08</td>
<td>2.318837</td>
<td>0.830687</td>
<td>7.864234e-14</td>
<td>1.643929e-13</td>
<td>0.025288</td>
<td>3.333199</td>
<td>10.672109</td>
<td>11.311688</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35</td>
<td>0.856504</td>
<td>0.000237</td>
<td>1.0</td>
<td>1.360312e-12</td>
<td>0.860652</td>
<td>0.067374</td>
<td>0.192203</td>
<td>0.258071</td>
<td>0.107286</td>
<td>0.777399</td>
<td>...</td>
<td>8.423951e+08</td>
<td>2.039681</td>
<td>0.993173</td>
<td>6.491681e-14</td>
<td>2.153582e-13</td>
<td>0.029056</td>
<td>3.839122</td>
<td>9.599664</td>
<td>13.331786</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>0.930783</td>
<td>0.000189</td>
<td>1.0</td>
<td>1.489148e-12</td>
<td>0.888709</td>
<td>0.046345</td>
<td>0.194218</td>
<td>0.231172</td>
<td>0.183409</td>
<td>0.831117</td>
<td>...</td>
<td>1.105337e+09</td>
<td>2.328963</td>
<td>0.866898</td>
<td>6.554262e-14</td>
<td>2.276119e-13</td>
<td>0.023463</td>
<td>3.689994</td>
<td>11.705067</td>
<td>7.102036</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">64</td>
<td>0.859688</td>
<td>0.000235</td>
<td>1.0</td>
<td>3.426082e-12</td>
<td>0.791894</td>
<td>0.052688</td>
<td>0.198979</td>
<td>0.230128</td>
<td>0.197351</td>
<td>0.842065</td>
<td>...</td>
<td>3.647771e+08</td>
<td>1.730236</td>
<td>0.919254</td>
<td>7.408027e-14</td>
<td>2.148666e-13</td>
<td>0.029782</td>
<td>1.697687</td>
<td>11.305181</td>
<td>13.115608</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1882</td>
<td>0.845869</td>
<td>0.000172</td>
<td>1.0</td>
<td>1.048237e-12</td>
<td>0.845831</td>
<td>0.080705</td>
<td>0.199110</td>
<td>0.334855</td>
<td>0.163015</td>
<td>0.764383</td>
<td>...</td>
<td>2.061369e+08</td>
<td>1.615056</td>
<td>0.959637</td>
<td>7.543702e-14</td>
<td>2.598267e-13</td>
<td>0.027358</td>
<td>1.738303</td>
<td>9.792686</td>
<td>12.376386</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1910</td>
<td>0.891865</td>
<td>0.000236</td>
<td>1.0</td>
<td>1.587349e-12</td>
<td>0.841325</td>
<td>0.047596</td>
<td>0.190368</td>
<td>0.187888</td>
<td>0.114146</td>
<td>0.818767</td>
<td>...</td>
<td>8.062927e+08</td>
<td>1.649409</td>
<td>0.853218</td>
<td>7.850763e-14</td>
<td>2.357539e-13</td>
<td>0.024782</td>
<td>1.406129</td>
<td>6.738719</td>
<td>13.099119</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1917</td>
<td>0.917349</td>
<td>0.000172</td>
<td>1.0</td>
<td>6.231750e-13</td>
<td>0.847565</td>
<td>0.047245</td>
<td>0.195349</td>
<td>0.244040</td>
<td>0.192836</td>
<td>0.789315</td>
<td>...</td>
<td>9.777013e+08</td>
<td>1.535770</td>
<td>0.824097</td>
<td>5.226121e-14</td>
<td>2.318500e-13</td>
<td>0.024413</td>
<td>1.599696</td>
<td>9.447559</td>
<td>0.599285</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1918</td>
<td>0.979824</td>
<td>0.000215</td>
<td>1.0</td>
<td>7.663475e-13</td>
<td>0.834459</td>
<td>0.092777</td>
<td>0.203782</td>
<td>0.191754</td>
<td>0.104075</td>
<td>0.832115</td>
<td>...</td>
<td>2.886042e+08</td>
<td>2.043540</td>
<td>0.833630</td>
<td>5.487253e-14</td>
<td>1.306311e-13</td>
<td>0.031694</td>
<td>1.449804</td>
<td>8.414919</td>
<td>3.970192</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1926</td>
<td>0.884257</td>
<td>0.000212</td>
<td>1.0</td>
<td>9.887656e-13</td>
<td>0.794346</td>
<td>0.042550</td>
<td>0.190401</td>
<td>0.318149</td>
<td>0.216369</td>
<td>0.817676</td>
<td>...</td>
<td>5.898101e+08</td>
<td>2.199278</td>
<td>0.968034</td>
<td>6.179313e-14</td>
<td>2.376930e-13</td>
<td>0.028122</td>
<td>2.487448</td>
<td>9.333051</td>
<td>11.542919</td>
<td>blue</td>
</tr>
</tbody>
</table>

<p>177 rows × 22 columns</p>
</div>
</div>
</div>
<div id="c1fd2466-8910-4d30-b5aa-06dca28ee3af" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints.loc[net_carbon <span class="op">&lt;</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">V_closed</th>
<th data-quarto-table-cell-role="th">V_open</th>
<th data-quarto-table-cell-role="th">Os_closed</th>
<th data-quarto-table-cell-role="th">Os_open</th>
<th data-quarto-table-cell-role="th">Photons</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">Os_dif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>0.000134</td>
<td>0.000278</td>
<td>0.033181</td>
<td>0.140030</td>
<td>0.013079</td>
<td>0.004855</td>
<td>0.106849</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">30</td>
<td>0.000272</td>
<td>0.000640</td>
<td>0.063820</td>
<td>0.310722</td>
<td>0.027134</td>
<td>0.007218</td>
<td>0.246902</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">35</td>
<td>0.000391</td>
<td>0.000706</td>
<td>0.109738</td>
<td>0.371630</td>
<td>0.037644</td>
<td>0.011231</td>
<td>0.261892</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45</td>
<td>0.000519</td>
<td>0.001100</td>
<td>0.133538</td>
<td>0.606216</td>
<td>0.055639</td>
<td>0.007850</td>
<td>0.472678</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">64</td>
<td>0.000124</td>
<td>0.000384</td>
<td>0.020705</td>
<td>0.204952</td>
<td>0.033219</td>
<td>0.004784</td>
<td>0.184247</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1882</td>
<td>0.000081</td>
<td>0.000206</td>
<td>0.013085</td>
<td>0.098841</td>
<td>0.013994</td>
<td>0.002551</td>
<td>0.085757</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1910</td>
<td>0.000279</td>
<td>0.000617</td>
<td>0.040490</td>
<td>0.207920</td>
<td>0.027690</td>
<td>0.010562</td>
<td>0.167430</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1917</td>
<td>0.000308</td>
<td>0.000709</td>
<td>0.044057</td>
<td>0.291729</td>
<td>0.022555</td>
<td>0.000586</td>
<td>0.247672</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1918</td>
<td>0.000061</td>
<td>0.000171</td>
<td>0.010122</td>
<td>0.069783</td>
<td>0.011858</td>
<td>0.001146</td>
<td>0.059661</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1926</td>
<td>0.000231</td>
<td>0.000480</td>
<td>0.050001</td>
<td>0.234255</td>
<td>0.015845</td>
<td>0.006808</td>
<td>0.184254</td>
</tr>
</tbody>
</table>

<p>177 rows × 7 columns</p>
</div>
</div>
</div>
<p>Ok they are the same just with different light colours. Is it the photon/od_dif ratio?</p>
<div id="85582fa5-bc3c-4502-9ab3-b0e0cc5a8a5e" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints.loc[<span class="dv">180</span>, <span class="st">"Photons"</span>] <span class="op">/</span> scan_gc_constraints.loc[<span class="dv">180</span>, <span class="st">"Os_dif"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>0.8286998886406594</code></pre>
</div>
</div>
<div id="510f5386-6eda-4406-b821-13cfec87e3e3" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(scan_gc_constraints.loc[:, <span class="st">"Photons"</span>] <span class="op">/</span> scan_gc_constraints.loc[:, <span class="st">"Os_dif"</span>]).<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>0.028310817388733575</code></pre>
</div>
</div>
<p>Yes, it has the lowest photon:od_diff ratio of any combination</p>
</section>
</section>
<section id="at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink" class="level2">
<h2 class="anchored" data-anchor-id="at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink">At our predicted level of osmolarity and other guard cell parameters, what would FqFm.R_ch need to be for guard cell to act as a sink?</h2>
<p><span class="math inline">\(e = FqFm \cdot R_{ch} \cdot R_{ch_{vol}}\)</span> &lt;- We want to know e, that is the capacity of guard cell vs mesophyll. Function of efficiency, number of chloroplasts, and valume of chloroplasts</p>
<p><span class="math inline">\(P_{gc} = e \cdot v\_prop_{gc} \cdot P\)</span></p>
<p><span class="math inline">\(e = \frac{P_{gc}}{v\_prop_{gc} \cdot P}\)</span></p>
<div id="62f351ab-5a9f-4cd9-ae51-3341bf0fed18" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="dv">150</span> <span class="op">*</span> paper_constraints.P_abs</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> P <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span>  <span class="co"># umolessec-1 -&gt; mmolhr-1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4088bfff-35c8-4a50-be2c-166c874351b9" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>V_l <span class="op">=</span> (</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    paper_constraints.T_l <span class="op">*</span> paper_constraints.A_l</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># volume of leaf is area x thickness</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>V_l <span class="op">=</span> V_l <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">3</span>  <span class="co"># (Total leaf volume) m3 -&gt; dm3 = 10**3</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>V_gc <span class="op">=</span> (</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    paper_constraints.V_gc_ind <span class="op">*</span> paper_constraints.N_gcs</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># total volume of gc in leaf</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co"># volume of meosphyll is leaf that isn't epidermis or air</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>V_me <span class="op">=</span> V_l <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> paper_constraints.L_epidermis) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> paper_constraints.L_air)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>v_prop_gc <span class="op">=</span> V_gc <span class="op">/</span> V_me  <span class="co"># volume of gc is negligable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="10d7f070-2a04-4835-9650-acd7d633440a" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> np.array([total_photons_per_day, gc_features.Os_dif]).T</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>lm_1.fit(features, response)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Intercept: </span><span class="sc">{</span>lm_1<span class="sc">.</span>intercept_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_1.coef_, index<span class="op">=</span>[<span class="st">"Photons per day"</span>, <span class="st">"Os dif"</span>]).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.000000
Coefficient of determination, r2 = 0.997839
Intercept: -2.9943170116709816e-07</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Os dif</td>
<td>-0.000042</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Photons per day</td>
<td>0.000020</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>$ C_{net} = -3^{-5}Os_{dif} + 2^{-5}P_{day} - 6.80 ^{-8}$</p>
<p>$ 0 = -3^{-5} + 2^{-5}P_{day} - 6.80 ^{-8}$</p>
<p>$ = P_{day}$</p>
<div id="77c9e72d-5d8d-4bda-b01f-fd7310c8ffaf" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>os_dif_coef <span class="op">=</span> lm_1.coef_[<span class="dv">1</span>]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>photons_per_day_coef <span class="op">=</span> lm_1.coef_[<span class="dv">0</span>]</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>os_in_selected_scenarios <span class="op">=</span> paper_gc_constraints.Os_dif</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>intercept <span class="op">=</span> lm_1.intercept_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e6318f8a-ac2c-4a36-b7b1-5fa5a178853b" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>photons_needed <span class="op">=</span> (</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>    intercept <span class="op">-</span> os_dif_coef <span class="op">*</span> os_in_selected_scenarios</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>) <span class="op">/</span> photons_per_day_coef</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>photons_needed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>0.01766160051488187</code></pre>
</div>
</div>
<div id="5136cc42-3fe8-4e9f-9553-f0b081b5eea9" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>total_photons_per_day.<span class="bu">min</span>() <span class="op">/</span> photons_needed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>2.1088116678656323</code></pre>
</div>
</div>
<p>So at that osmolarity for the guard cell to act as sink tissue the total level of photons coming in would have to be 15x lower than we see in any of our scenarios, which will be for blue light</p>
<div id="be8dbb38-c7d8-403c-b0f6-d23035ba3247" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>photon_influx <span class="op">=</span> photons_needed <span class="op">/</span> <span class="fl">11.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(e = \frac{P_{gc}}{v\_prop_{gc} \cdot P}\)</span></p>
<div id="6eb70864-ff9e-41ee-8411-85172b950ccd" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>e <span class="op">=</span> photon_influx <span class="op">/</span> (v_prop_gc <span class="op">*</span> P)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>e <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>0.10441977210694658</code></pre>
</div>
</div>
<p>So the capacity for photosynthesis in the guard cell only needs to be 0.1% of that of the mesophyll to act as a source tissue</p>
<section id="what-is-the-range-of-photosynthetic-capacities-that-we-use" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-range-of-photosynthetic-capacities-that-we-use">What is the range of photosynthetic capacities that we use?</h3>
<div id="fbb053bd-1302-4401-bd6b-51f9fec6b4f0" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>capacity_percentages <span class="op">=</span> (scan_constraints.FqFm <span class="op">*</span> scan_constraints.R_ch) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"High: </span><span class="sc">{</span>capacity_percentages<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Low: </span><span class="sc">{</span>capacity_percentages<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>High: 16.086936580407595
Low: 2.773358075436272</code></pre>
</div>
</div>
</section>
</section>
<section id="c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much" class="level2">
<h2 class="anchored" data-anchor-id="c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much">7c - So does the ATPase have an effect on starch if not on hexose export very much?</h2>
<section id="how-many-solutions-utilise-starch" class="level3">
<h3 class="anchored" data-anchor-id="how-many-solutions-utilise-starch">How many solutions utilise starch?</h3>
<div id="32f80960-31b9-4b8c-88d2-b0714ca535dc" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>starch <span class="op">=</span> scan_results.STARCH_p_gc_Linker_1 <span class="op">-</span> scan_results.STARCH_p_gc_Linker_2</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>(starch <span class="op">&gt;</span> <span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> or </span><span class="sc">{</span>(starch <span class="op">&gt;</span> <span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(starch) <span class="op">*</span> <span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1892 or 98%</code></pre>
</div>
</div>
</section>
</section>
<section id="in-how-many-of-those-solutions-is-the-atpase-constrained" class="level2">
<h2 class="anchored" data-anchor-id="in-how-many-of-those-solutions-is-the-atpase-constrained">In how many of those solutions is the ATPase constrained?</h2>
<div id="4d82ffae-af11-49e6-bda9-d4d3cc756451" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>atpase_constrained <span class="op">=</span> (</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">abs</span>(scan_gc_constraints.ATPase <span class="op">-</span> scan_results.PROTON_ATPase_c_gc_2) <span class="op">&lt;</span> <span class="fl">0.000001</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>(atpase_constrained <span class="op">&amp;</span> starch <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>1864</code></pre>
</div>
</div>
<div id="0a9e9556" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>((scan_gc_constraints.ATPase <span class="op">-</span> scan_results.PROTON_ATPase_c_gc_2) <span class="op">&lt;</span> <span class="fl">0.000001</span>).<span class="bu">sum</span>() <span class="op">/</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>0.985200845665962</code></pre>
</div>
</div>
<div id="2f8d1f37" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>(starch <span class="op">&lt;=</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>42</code></pre>
</div>
</div>
<div id="3eb3ab54" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints[(atpase_constrained <span class="op">&amp;</span> (starch <span class="op">==</span> <span class="dv">0</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">V_closed</th>
<th data-quarto-table-cell-role="th">V_open</th>
<th data-quarto-table-cell-role="th">Os_closed</th>
<th data-quarto-table-cell-role="th">Os_open</th>
<th data-quarto-table-cell-role="th">Photons</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">Os_dif</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
<p>So there is one solution which doesn’t</p>
<div id="f8070df8-2870-4318-b3c1-e0cc63eda433" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints[(atpase_constrained <span class="op">&amp;</span> starch <span class="op">&lt;</span> <span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">V_closed</th>
<th data-quarto-table-cell-role="th">V_open</th>
<th data-quarto-table-cell-role="th">Os_closed</th>
<th data-quarto-table-cell-role="th">Os_open</th>
<th data-quarto-table-cell-role="th">Photons</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">Os_dif</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
<div id="b4be9b0f-1f12-4074-8739-0d381c55808c" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(scan_gc_constraints.loc[1685] - scan_gc_constraints.mean()) / scan_gc_constraints.std()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>High photons, high ATPase, low osmolarity dif</p>
</section>
<section id="how-many-constrained-solutions-dont-use-starch" class="level2">
<h2 class="anchored" data-anchor-id="how-many-constrained-solutions-dont-use-starch">How many constrained solutions don’t use starch?</h2>
<div id="8604860f-4e58-40d3-81c6-19d365080342" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>(atpase_constrained <span class="op">&amp;</span> (starch <span class="op">==</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>0</code></pre>
</div>
</div>
<div id="1aa2287b-ac73-4b9a-affa-393e6f58fc16" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints[(atpase_constrained <span class="op">&amp;</span> (starch <span class="op">==</span> <span class="dv">0</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">V_closed</th>
<th data-quarto-table-cell-role="th">V_open</th>
<th data-quarto-table-cell-role="th">Os_closed</th>
<th data-quarto-table-cell-role="th">Os_open</th>
<th data-quarto-table-cell-role="th">Photons</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">Os_dif</th>
</tr>
</thead>
<tbody>
</tbody>
</table>

</div>
</div>
</div>
<div id="ad9cbef1-d61d-4f42-8489-d911171411f3" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(scan_gc_constraints.loc[1779] - scan_gc_constraints.mean()) / scan_gc_constraints.std()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Osmolarity difference is low, photons are high, atpase is low. Closed osmolarity is high, forcing the use of something else?</p>
<p>Increase per GC allows comparison with literature values</p>
<div id="eb337c71-bb9f-4b06-b97d-f87823adc71d" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>starch_per_gc <span class="op">=</span> starch <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">/</span> scan_constraints.N_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span>  <span class="co"># fmol.gc-1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="81f6077a-9f54-4461-a129-9900472955d6" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>horrer_starch_level <span class="op">=</span> <span class="dv">184</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6eea00a3-eda9-43e4-afff-7a91c2cff634" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>os_increase_per_gc <span class="op">=</span> (</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    scan_gc_constraints.Os_dif <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">/</span> scan_constraints.N_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>protons_moved_per_gc <span class="op">=</span> (</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    scan_results.PROTON_ATPase_c_gc_2 <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">/</span> scan_constraints.N_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bcaf94ec-184b-4ab5-bb5b-51028a8339aa" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>protons_moved_per_gc.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>16.983568453252616</code></pre>
</div>
</div>
<div id="cb434c31-67e2-44d7-aca6-3c23441ea6e4" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> starch_vs_os_subfig(ax):</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    dot_size <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    norm <span class="op">=</span> Normalize(vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    mappable <span class="op">=</span> ScalarMappable(norm<span class="op">=</span>norm, cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    ax.plot([<span class="dv">0</span>, <span class="dv">600</span>], [<span class="dv">0</span>, <span class="dv">600</span>], c<span class="op">=</span><span class="st">"grey"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, clip_on<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>    sc <span class="op">=</span> ax.scatter(</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>        os_increase_per_gc,</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>        starch_per_gc,</span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>        s<span class="op">=</span>dot_size,</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>        c<span class="op">=</span>protons_moved_per_gc,</span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>        norm<span class="op">=</span>norm,</span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>        cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>),</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>    cbaxes <span class="op">=</span> ax.inset_axes([<span class="fl">0.15</span>, <span class="fl">0.93</span>, <span class="fl">0.40</span>, <span class="fl">0.05</span>])</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>    cbar <span class="op">=</span> plt.colorbar(mappable, cax<span class="op">=</span>cbaxes, ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">15</span>], orientation<span class="op">=</span><span class="st">"horizontal"</span>)</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>    cbar.set_label(<span class="st">"Total H$^{+}$ export</span><span class="ch">\n</span><span class="st">(fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>    y_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>    y_min <span class="op">=</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a>    x_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a>    x_min <span class="op">=</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(y_min, y_max)</span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(x_min, x_max)</span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"left"</span>].set_bounds(<span class="dv">0</span>, y_max)</span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"bottom"</span>].set_bounds(<span class="dv">0</span>, x_max)</span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(<span class="dv">200</span>))</span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(<span class="dv">200</span>))</span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="dv">1</span>)</span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Osmolarity increase (fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="vs">r"Starch degradation (fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.hlines(-155, xmin=0.15, xmax=0.99, clip_on=False, linewidth=1, color='.15')</span></span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.hlines(</span></span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a><span class="co">#         184,</span></span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a><span class="co">#         xmin=0,</span></span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a><span class="co">#         xmax=x_max,</span></span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a><span class="co">#         linewidth=1,</span></span>
<span id="cb103-45"><a href="#cb103-45" aria-hidden="true" tabindex="-1"></a><span class="co">#         linestyle="--",</span></span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a><span class="co">#         color=sns.color_palette()[6],</span></span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb103-48"><a href="#cb103-48" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.text(</span></span>
<span id="cb103-49"><a href="#cb103-49" aria-hidden="true" tabindex="-1"></a><span class="co">#         x_max,</span></span>
<span id="cb103-50"><a href="#cb103-50" aria-hidden="true" tabindex="-1"></a><span class="co">#         175,</span></span>
<span id="cb103-51"><a href="#cb103-51" aria-hidden="true" tabindex="-1"></a><span class="co">#         "Horrer et al. (2016)",</span></span>
<span id="cb103-52"><a href="#cb103-52" aria-hidden="true" tabindex="-1"></a><span class="co">#         ha="right",</span></span>
<span id="cb103-53"><a href="#cb103-53" aria-hidden="true" tabindex="-1"></a><span class="co">#         va="top",</span></span>
<span id="cb103-54"><a href="#cb103-54" aria-hidden="true" tabindex="-1"></a><span class="co">#         size="x-small",</span></span>
<span id="cb103-55"><a href="#cb103-55" aria-hidden="true" tabindex="-1"></a><span class="co">#         color=sns.color_palette()[6],</span></span>
<span id="cb103-56"><a href="#cb103-56" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb103-57"><a href="#cb103-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-58"><a href="#cb103-58" aria-hidden="true" tabindex="-1"></a><span class="co">#     paper_scenarios_colour = sns.color_palette()[2]</span></span>
<span id="cb103-59"><a href="#cb103-59" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.vlines(</span></span>
<span id="cb103-60"><a href="#cb103-60" aria-hidden="true" tabindex="-1"></a><span class="co">#         26.83,</span></span>
<span id="cb103-61"><a href="#cb103-61" aria-hidden="true" tabindex="-1"></a><span class="co">#         ymin=0,</span></span>
<span id="cb103-62"><a href="#cb103-62" aria-hidden="true" tabindex="-1"></a><span class="co">#         ymax=110,</span></span>
<span id="cb103-63"><a href="#cb103-63" aria-hidden="true" tabindex="-1"></a><span class="co">#         linewidth=1,</span></span>
<span id="cb103-64"><a href="#cb103-64" aria-hidden="true" tabindex="-1"></a><span class="co">#         linestyle="--",</span></span>
<span id="cb103-65"><a href="#cb103-65" aria-hidden="true" tabindex="-1"></a><span class="co">#         color=paper_scenarios_colour,</span></span>
<span id="cb103-66"><a href="#cb103-66" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb103-67"><a href="#cb103-67" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.text(</span></span>
<span id="cb103-68"><a href="#cb103-68" aria-hidden="true" tabindex="-1"></a><span class="co">#         50,</span></span>
<span id="cb103-69"><a href="#cb103-69" aria-hidden="true" tabindex="-1"></a><span class="co">#         120,</span></span>
<span id="cb103-70"><a href="#cb103-70" aria-hidden="true" tabindex="-1"></a><span class="co">#         "Paper\nscenarios",</span></span>
<span id="cb103-71"><a href="#cb103-71" aria-hidden="true" tabindex="-1"></a><span class="co">#         ha="center",</span></span>
<span id="cb103-72"><a href="#cb103-72" aria-hidden="true" tabindex="-1"></a><span class="co">#         va="bottom",</span></span>
<span id="cb103-73"><a href="#cb103-73" aria-hidden="true" tabindex="-1"></a><span class="co">#         size="x-small",</span></span>
<span id="cb103-74"><a href="#cb103-74" aria-hidden="true" tabindex="-1"></a><span class="co">#         color=paper_scenarios_colour,</span></span>
<span id="cb103-75"><a href="#cb103-75" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb103-76"><a href="#cb103-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-77"><a href="#cb103-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb103-78"><a href="#cb103-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-79"><a href="#cb103-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-80"><a href="#cb103-80" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb103-81"><a href="#cb103-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-82"><a href="#cb103-82" aria-hidden="true" tabindex="-1"></a>starch_vs_os_subfig(ax)</span>
<span id="cb103-83"><a href="#cb103-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-84"><a href="#cb103-84" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/atpase_vs_starch.svg"</span>)</span>
<span id="cb103-85"><a href="#cb103-85" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/atpase_vs_starch.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-69-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="how-do-starch-levels-vary-with-whiteblue-light" class="level3">
<h3 class="anchored" data-anchor-id="how-do-starch-levels-vary-with-whiteblue-light">How do starch levels vary with white/blue light?</h3>
<div id="9c3726b7" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>starch_per_gc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>0       452.289024
1       277.547788
2         4.237398
3       167.427081
4        88.409571
           ...    
1931    401.554966
1932    111.326430
1933    269.642074
1934     81.257996
1935    271.281498
Length: 1934, dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="how-is-starch-used" class="level2">
<h2 class="anchored" data-anchor-id="how-is-starch-used">How is starch used?</h2>
<p>What proportion of white light solutions that degrade starch use it for osmoticum?</p>
<div id="bd02ddf2-e176-418a-9d26-3d054e305660" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>        (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (scan_results.RXN_2141_p_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">sum</span>()</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>) <span class="op">/</span> ((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>100.0</code></pre>
</div>
</div>
<p>What proportion of white light solutions that degrade starch use it for energy?</p>
<div id="a1bbfa45-4789-4dd5-b71a-985849cde879" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>        (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">sum</span>()</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>) <span class="op">/</span> ((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>37.379162191192265</code></pre>
</div>
</div>
<p>In the solutions that use it for energy, what is the average % used for energy?</p>
<div id="aa7e3391-22c1-4629-8038-1940b31bbc69" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>            scan_results[</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>                (</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>                    (</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>                        (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>                        <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>                        <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>            ].MALTODEG_RXN_c_gc_2</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">/</span> starch[</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>                (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>)</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>                <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>                <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>3.390568533696099</code></pre>
</div>
</div>
<p>What proportion of blue light solutions that degrade starch use it for osmoticum?</p>
<div id="7946a6fc-e211-4521-b8d2-db68f6f5f529" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>        (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (scan_results.RXN_2141_p_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">sum</span>()</span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>) <span class="op">/</span> ((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>96.98231009365244</code></pre>
</div>
</div>
<div id="48a57080-61c9-4a1b-ad14-9b6fa74f25bb" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>() <span class="op">-</span> (</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>        (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (scan_results.RXN_2141_p_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">sum</span>()</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>29</code></pre>
</div>
</div>
<p>29 solutions doesn’t</p>
<div id="4fcdc3a4-3eee-455c-9494-a891569e0059" class="cell" data-scrolled="true" data-execution_count="76">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>scan_constraints[</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>        (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> <span class="op">~</span>(scan_results.RXN_2141_p_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">P_abs</th>
<th data-quarto-table-cell-role="th">T_l</th>
<th data-quarto-table-cell-role="th">A_l</th>
<th data-quarto-table-cell-role="th">V_gc_ind</th>
<th data-quarto-table-cell-role="th">FqFm</th>
<th data-quarto-table-cell-role="th">R_ch</th>
<th data-quarto-table-cell-role="th">R_ch_vol</th>
<th data-quarto-table-cell-role="th">L_air</th>
<th data-quarto-table-cell-role="th">L_epidermis</th>
<th data-quarto-table-cell-role="th">Vac_frac</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">N_gcs</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">m</th>
<th data-quarto-table-cell-role="th">r</th>
<th data-quarto-table-cell-role="th">s</th>
<th data-quarto-table-cell-role="th">C_apo</th>
<th data-quarto-table-cell-role="th">A_closed</th>
<th data-quarto-table-cell-role="th">A_open</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">light</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1017</td>
<td>0.982189</td>
<td>0.000231</td>
<td>1.0</td>
<td>1.217851e-12</td>
<td>0.806859</td>
<td>0.073278</td>
<td>0.211816</td>
<td>0.312352</td>
<td>0.170798</td>
<td>0.850346</td>
<td>...</td>
<td>7.505322e+08</td>
<td>2.216148</td>
<td>0.988893</td>
<td>7.629564e-14</td>
<td>2.378212e-13</td>
<td>0.036241</td>
<td>3.213625</td>
<td>3.269583</td>
<td>5.188912</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1029</td>
<td>0.987023</td>
<td>0.000221</td>
<td>1.0</td>
<td>1.629365e-12</td>
<td>0.838141</td>
<td>0.096801</td>
<td>0.204151</td>
<td>0.251819</td>
<td>0.217884</td>
<td>0.765830</td>
<td>...</td>
<td>3.634520e+08</td>
<td>1.950142</td>
<td>0.846086</td>
<td>7.725629e-14</td>
<td>1.043478e-13</td>
<td>0.028292</td>
<td>2.862462</td>
<td>3.198156</td>
<td>13.387886</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1056</td>
<td>0.833108</td>
<td>0.000195</td>
<td>1.0</td>
<td>1.641114e-12</td>
<td>0.848315</td>
<td>0.162755</td>
<td>0.206171</td>
<td>0.278300</td>
<td>0.189228</td>
<td>0.863030</td>
<td>...</td>
<td>4.977284e+08</td>
<td>1.533894</td>
<td>0.896850</td>
<td>7.795038e-14</td>
<td>1.909829e-13</td>
<td>0.034884</td>
<td>3.554507</td>
<td>3.763593</td>
<td>14.205187</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1101</td>
<td>0.986662</td>
<td>0.000234</td>
<td>1.0</td>
<td>4.080272e-12</td>
<td>0.833938</td>
<td>0.038088</td>
<td>0.195959</td>
<td>0.208027</td>
<td>0.195915</td>
<td>0.851504</td>
<td>...</td>
<td>1.080920e+09</td>
<td>2.176108</td>
<td>0.871806</td>
<td>6.374026e-14</td>
<td>1.607315e-13</td>
<td>0.031215</td>
<td>2.021054</td>
<td>2.957040</td>
<td>13.642663</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1175</td>
<td>0.845082</td>
<td>0.000195</td>
<td>1.0</td>
<td>3.099346e-12</td>
<td>0.858672</td>
<td>0.105619</td>
<td>0.192160</td>
<td>0.271365</td>
<td>0.122900</td>
<td>0.805677</td>
<td>...</td>
<td>1.156622e+09</td>
<td>1.676400</td>
<td>0.938192</td>
<td>7.393047e-14</td>
<td>1.742883e-13</td>
<td>0.034981</td>
<td>3.772808</td>
<td>3.898576</td>
<td>11.481076</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1210</td>
<td>0.979145</td>
<td>0.000175</td>
<td>1.0</td>
<td>5.704240e-13</td>
<td>0.888548</td>
<td>0.072428</td>
<td>0.191789</td>
<td>0.325010</td>
<td>0.203983</td>
<td>0.860514</td>
<td>...</td>
<td>1.036523e+09</td>
<td>1.899936</td>
<td>0.859060</td>
<td>5.463702e-14</td>
<td>1.576704e-13</td>
<td>0.028699</td>
<td>3.722164</td>
<td>4.071019</td>
<td>8.231288</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1241</td>
<td>0.964159</td>
<td>0.000240</td>
<td>1.0</td>
<td>3.888226e-12</td>
<td>0.849131</td>
<td>0.040710</td>
<td>0.202661</td>
<td>0.308670</td>
<td>0.218431</td>
<td>0.872428</td>
<td>...</td>
<td>3.693487e+08</td>
<td>2.243153</td>
<td>0.842068</td>
<td>6.859716e-14</td>
<td>2.559610e-13</td>
<td>0.035843</td>
<td>3.687364</td>
<td>3.924401</td>
<td>16.420545</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1249</td>
<td>0.936919</td>
<td>0.000209</td>
<td>1.0</td>
<td>1.257865e-12</td>
<td>0.826065</td>
<td>0.170801</td>
<td>0.201451</td>
<td>0.200907</td>
<td>0.221662</td>
<td>0.862510</td>
<td>...</td>
<td>2.768268e+08</td>
<td>1.579182</td>
<td>0.975663</td>
<td>7.358545e-14</td>
<td>2.629005e-13</td>
<td>0.034054</td>
<td>2.918035</td>
<td>3.666386</td>
<td>16.455016</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1271</td>
<td>0.894960</td>
<td>0.000226</td>
<td>1.0</td>
<td>2.625296e-12</td>
<td>0.794778</td>
<td>0.090898</td>
<td>0.192567</td>
<td>0.205657</td>
<td>0.192150</td>
<td>0.771838</td>
<td>...</td>
<td>5.185705e+08</td>
<td>1.732175</td>
<td>0.982479</td>
<td>5.191611e-14</td>
<td>2.078991e-13</td>
<td>0.033018</td>
<td>2.881912</td>
<td>3.278714</td>
<td>10.054394</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1347</td>
<td>0.937104</td>
<td>0.000226</td>
<td>1.0</td>
<td>2.073399e-12</td>
<td>0.877991</td>
<td>0.157195</td>
<td>0.191900</td>
<td>0.227209</td>
<td>0.225836</td>
<td>0.794047</td>
<td>...</td>
<td>2.618422e+08</td>
<td>1.733078</td>
<td>0.888186</td>
<td>5.059401e-14</td>
<td>2.003447e-13</td>
<td>0.023230</td>
<td>3.869395</td>
<td>4.290222</td>
<td>12.594885</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1398</td>
<td>0.924224</td>
<td>0.000175</td>
<td>1.0</td>
<td>8.730863e-13</td>
<td>0.804098</td>
<td>0.113418</td>
<td>0.198257</td>
<td>0.249691</td>
<td>0.188820</td>
<td>0.869304</td>
<td>...</td>
<td>2.519070e+08</td>
<td>2.475275</td>
<td>0.986365</td>
<td>5.905248e-14</td>
<td>2.007580e-13</td>
<td>0.035799</td>
<td>3.375259</td>
<td>3.767706</td>
<td>13.067527</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1415</td>
<td>0.980463</td>
<td>0.000186</td>
<td>1.0</td>
<td>2.216273e-12</td>
<td>0.833689</td>
<td>0.123501</td>
<td>0.191071</td>
<td>0.215862</td>
<td>0.172692</td>
<td>0.880035</td>
<td>...</td>
<td>4.498390e+08</td>
<td>1.516520</td>
<td>0.868986</td>
<td>6.725712e-14</td>
<td>2.446887e-13</td>
<td>0.029044</td>
<td>2.734507</td>
<td>3.267102</td>
<td>15.278437</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1447</td>
<td>0.936485</td>
<td>0.000214</td>
<td>1.0</td>
<td>1.166534e-12</td>
<td>0.804583</td>
<td>0.064945</td>
<td>0.212629</td>
<td>0.306904</td>
<td>0.192820</td>
<td>0.899093</td>
<td>...</td>
<td>1.006072e+09</td>
<td>2.229371</td>
<td>0.889104</td>
<td>7.800326e-14</td>
<td>1.362171e-13</td>
<td>0.025047</td>
<td>3.167684</td>
<td>3.208058</td>
<td>2.280317</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1448</td>
<td>0.966670</td>
<td>0.000234</td>
<td>1.0</td>
<td>2.958310e-12</td>
<td>0.880085</td>
<td>0.164133</td>
<td>0.208941</td>
<td>0.256087</td>
<td>0.185230</td>
<td>0.857323</td>
<td>...</td>
<td>2.950038e+08</td>
<td>2.331925</td>
<td>0.969200</td>
<td>6.444187e-14</td>
<td>2.834842e-13</td>
<td>0.033098</td>
<td>2.317668</td>
<td>3.042316</td>
<td>16.947977</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1491</td>
<td>0.974679</td>
<td>0.000208</td>
<td>1.0</td>
<td>4.076222e-12</td>
<td>0.854519</td>
<td>0.064982</td>
<td>0.193118</td>
<td>0.366199</td>
<td>0.142774</td>
<td>0.786920</td>
<td>...</td>
<td>2.322279e+08</td>
<td>2.420792</td>
<td>0.998249</td>
<td>7.561923e-14</td>
<td>1.951285e-13</td>
<td>0.028007</td>
<td>3.455625</td>
<td>3.655766</td>
<td>5.111005</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1493</td>
<td>0.963094</td>
<td>0.000203</td>
<td>1.0</td>
<td>1.666351e-12</td>
<td>0.804195</td>
<td>0.045097</td>
<td>0.201921</td>
<td>0.242176</td>
<td>0.169241</td>
<td>0.808959</td>
<td>...</td>
<td>3.329225e+08</td>
<td>2.363713</td>
<td>0.949282</td>
<td>6.266396e-14</td>
<td>2.838072e-13</td>
<td>0.030682</td>
<td>3.007735</td>
<td>3.103710</td>
<td>5.312710</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1603</td>
<td>0.828798</td>
<td>0.000182</td>
<td>1.0</td>
<td>2.256641e-12</td>
<td>0.823090</td>
<td>0.156348</td>
<td>0.190161</td>
<td>0.341647</td>
<td>0.136510</td>
<td>0.863669</td>
<td>...</td>
<td>1.001502e+09</td>
<td>2.262333</td>
<td>0.826955</td>
<td>5.891340e-14</td>
<td>1.276337e-13</td>
<td>0.037063</td>
<td>1.408121</td>
<td>2.911160</td>
<td>16.306092</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1618</td>
<td>0.860350</td>
<td>0.000239</td>
<td>1.0</td>
<td>2.638787e-12</td>
<td>0.805063</td>
<td>0.075918</td>
<td>0.202866</td>
<td>0.263651</td>
<td>0.217483</td>
<td>0.822192</td>
<td>...</td>
<td>6.891091e+08</td>
<td>1.943550</td>
<td>0.962856</td>
<td>5.344074e-14</td>
<td>2.932053e-13</td>
<td>0.023835</td>
<td>2.757374</td>
<td>2.839959</td>
<td>13.055073</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1643</td>
<td>0.976380</td>
<td>0.000196</td>
<td>1.0</td>
<td>2.590073e-12</td>
<td>0.880679</td>
<td>0.112134</td>
<td>0.197380</td>
<td>0.199853</td>
<td>0.194168</td>
<td>0.888156</td>
<td>...</td>
<td>4.143898e+08</td>
<td>2.315024</td>
<td>0.956130</td>
<td>7.757519e-14</td>
<td>1.819379e-13</td>
<td>0.024353</td>
<td>2.559500</td>
<td>3.075319</td>
<td>11.496986</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1646</td>
<td>0.904437</td>
<td>0.000191</td>
<td>1.0</td>
<td>2.890408e-12</td>
<td>0.855971</td>
<td>0.090535</td>
<td>0.211633</td>
<td>0.204026</td>
<td>0.171637</td>
<td>0.763252</td>
<td>...</td>
<td>6.682905e+08</td>
<td>2.352557</td>
<td>0.989896</td>
<td>6.372475e-14</td>
<td>1.918218e-13</td>
<td>0.033567</td>
<td>3.435310</td>
<td>3.815847</td>
<td>11.200469</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1649</td>
<td>0.884870</td>
<td>0.000204</td>
<td>1.0</td>
<td>1.979075e-12</td>
<td>0.893797</td>
<td>0.126563</td>
<td>0.192962</td>
<td>0.217671</td>
<td>0.227905</td>
<td>0.830867</td>
<td>...</td>
<td>8.139443e+08</td>
<td>1.620203</td>
<td>0.873123</td>
<td>5.074189e-14</td>
<td>1.533827e-13</td>
<td>0.031353</td>
<td>2.452572</td>
<td>2.999165</td>
<td>15.016749</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1667</td>
<td>0.899727</td>
<td>0.000181</td>
<td>1.0</td>
<td>1.993103e-12</td>
<td>0.800412</td>
<td>0.172931</td>
<td>0.202179</td>
<td>0.349272</td>
<td>0.208027</td>
<td>0.798485</td>
<td>...</td>
<td>7.670398e+08</td>
<td>1.800158</td>
<td>0.835565</td>
<td>6.995006e-14</td>
<td>1.407586e-13</td>
<td>0.031113</td>
<td>3.087264</td>
<td>3.514388</td>
<td>7.141256</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1673</td>
<td>0.892106</td>
<td>0.000177</td>
<td>1.0</td>
<td>1.173797e-12</td>
<td>0.899135</td>
<td>0.163861</td>
<td>0.211231</td>
<td>0.285542</td>
<td>0.130093</td>
<td>0.825673</td>
<td>...</td>
<td>5.034766e+08</td>
<td>2.221621</td>
<td>0.883160</td>
<td>6.236762e-14</td>
<td>1.911845e-13</td>
<td>0.033061</td>
<td>2.937788</td>
<td>3.420623</td>
<td>11.979488</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1722</td>
<td>0.912601</td>
<td>0.000213</td>
<td>1.0</td>
<td>3.929522e-12</td>
<td>0.857296</td>
<td>0.115738</td>
<td>0.199913</td>
<td>0.219846</td>
<td>0.168834</td>
<td>0.820673</td>
<td>...</td>
<td>6.034846e+08</td>
<td>1.885533</td>
<td>0.834602</td>
<td>5.926701e-14</td>
<td>1.114504e-13</td>
<td>0.026448</td>
<td>3.925064</td>
<td>4.209788</td>
<td>9.645913</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1796</td>
<td>0.960272</td>
<td>0.000208</td>
<td>1.0</td>
<td>1.354988e-12</td>
<td>0.818793</td>
<td>0.089928</td>
<td>0.194593</td>
<td>0.186986</td>
<td>0.128720</td>
<td>0.791661</td>
<td>...</td>
<td>3.166402e+08</td>
<td>1.704774</td>
<td>0.950659</td>
<td>5.391275e-14</td>
<td>1.397527e-13</td>
<td>0.036585</td>
<td>1.860880</td>
<td>2.862753</td>
<td>14.719912</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1809</td>
<td>0.983844</td>
<td>0.000172</td>
<td>1.0</td>
<td>1.793328e-12</td>
<td>0.839484</td>
<td>0.139732</td>
<td>0.211760</td>
<td>0.273304</td>
<td>0.175407</td>
<td>0.804473</td>
<td>...</td>
<td>3.108818e+08</td>
<td>2.147187</td>
<td>0.931797</td>
<td>7.462592e-14</td>
<td>1.418139e-13</td>
<td>0.031565</td>
<td>2.515386</td>
<td>2.979493</td>
<td>14.923502</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1847</td>
<td>0.887374</td>
<td>0.000177</td>
<td>1.0</td>
<td>2.454361e-12</td>
<td>0.885623</td>
<td>0.064367</td>
<td>0.204107</td>
<td>0.344367</td>
<td>0.161916</td>
<td>0.755113</td>
<td>...</td>
<td>2.662198e+08</td>
<td>2.351035</td>
<td>0.805419</td>
<td>5.355258e-14</td>
<td>2.058304e-13</td>
<td>0.028790</td>
<td>3.046720</td>
<td>3.561324</td>
<td>12.764657</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1854</td>
<td>0.961591</td>
<td>0.000230</td>
<td>1.0</td>
<td>3.945766e-12</td>
<td>0.869408</td>
<td>0.117912</td>
<td>0.202073</td>
<td>0.199677</td>
<td>0.153533</td>
<td>0.896697</td>
<td>...</td>
<td>2.634596e+08</td>
<td>1.580251</td>
<td>0.963299</td>
<td>5.448800e-14</td>
<td>2.194085e-13</td>
<td>0.032646</td>
<td>2.411045</td>
<td>2.771418</td>
<td>15.957472</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1880</td>
<td>0.943448</td>
<td>0.000193</td>
<td>1.0</td>
<td>8.306288e-13</td>
<td>0.858448</td>
<td>0.095690</td>
<td>0.190071</td>
<td>0.213188</td>
<td>0.205013</td>
<td>0.835644</td>
<td>...</td>
<td>2.233424e+08</td>
<td>1.547798</td>
<td>0.803243</td>
<td>7.226665e-14</td>
<td>2.676576e-13</td>
<td>0.025830</td>
<td>3.005475</td>
<td>3.303471</td>
<td>12.003204</td>
<td>blue</td>
</tr>
</tbody>
</table>

<p>29 rows × 22 columns</p>
</div>
</div>
</div>
<p>What proportion of blue light solutions that degrade starch use it for energy?</p>
<div id="005f4ff3-5778-43c5-b2ef-ceeb192aa3ea" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>        (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>)</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">sum</span>()</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>) <span class="op">/</span> ((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>95.52549427679502</code></pre>
</div>
</div>
<div id="1a77be08-0458-4e74-a3ef-2002d5fd432c" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> <span class="op">~</span>(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>43</code></pre>
</div>
</div>
<p>43 solutions that use starch in blue light don’t use the energy pathway</p>
<div id="741d3e71-51a3-4e3e-94d8-93352ac97bee" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>            scan_results[</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>                (</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>                    (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>                    <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>                    <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>            ].MALTODEG_RXN_c_gc_2</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">/</span> starch[</span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>                (scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>)</span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>                <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a>                <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>6.917530468681961</code></pre>
</div>
</div>
<p>Average of 6.9% of starch degraded was used for energy</p>
</section>
<section id="d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear" class="level2">
<h2 class="anchored" data-anchor-id="d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear">7d - How does glucose increase during opening vary with starch, and why isn’t it totally linear?</h2>
<p>Is sucrose degaded in the cytoplasm in any solutions?</p>
<div id="31189645-c1c8-4029-aeb4-7d4720ecdd07" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>(scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"RXN_1461_c_gc_2"</span>] <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>0</code></pre>
</div>
</div>
<p>No</p>
<div id="0915cc19-d38a-45e6-ad61-f2374eddb8c7" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>sucrose_degraded_v <span class="op">=</span> scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"RXN_1461_v_gc_2"</span>] <span class="op">&gt;</span> <span class="fl">0.000001</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>no_sucrose_degraded_v <span class="op">=</span> scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"RXN_1461_v_gc_2"</span>] <span class="op">&lt;</span> <span class="fl">0.000001</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>glucose_import_into_vacuole <span class="op">=</span> (</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"GLC_PROTON_rev_cv_gc_2"</span>] <span class="op">&gt;</span> <span class="fl">0.000001</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>no_glucose_import_into_vacuole <span class="op">=</span> (</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>    scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"GLC_PROTON_rev_cv_gc_2"</span>] <span class="op">&lt;</span> <span class="fl">0.000001</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9a25c1e6-7c93-4c9b-a557-acd0742932b5" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>sucrose_deg_and_glc_import <span class="op">=</span> sucrose_degraded_v <span class="op">&amp;</span> glucose_import_into_vacuole</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>sucrose_deg_no_glc_import <span class="op">=</span> sucrose_degraded_v <span class="op">&amp;</span> no_glucose_import_into_vacuole</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>no_sucrose_deg_glc_import <span class="op">=</span> no_sucrose_degraded_v <span class="op">&amp;</span> glucose_import_into_vacuole</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>no_sucrose_deg_no_glc_import <span class="op">=</span> no_sucrose_degraded_v <span class="op">&amp;</span> no_glucose_import_into_vacuole</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a179f829-4a8e-4029-a7d3-a420255a21b6" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>    sucrose_deg_and_glc_import,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    sucrose_deg_no_glc_import,</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    no_sucrose_deg_glc_import,</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    no_sucrose_deg_no_glc_import,</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">"+ S.d. + G.i."</span>, <span class="st">"+ S.d - G.i."</span>, <span class="st">"- S.d + G.i."</span>, <span class="st">"- S.d - G.i."</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="576be781-8aea-4c28-8d0f-1d5533a183f7" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition, label <span class="kw">in</span> <span class="bu">zip</span>(conditions, labels):</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"Length: </span><span class="sc">{</span>(condition)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>((condition).<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(scan_constraints[starch <span class="op">&gt;</span> <span class="dv">0</span>]) <span class="op">*</span> <span class="dv">100</span>)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">1</span>)<span class="sc">}</span><span class="ss">%)"</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    starch_proportion <span class="op">=</span> (</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>            scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].STARCH_p_gc_Linker_1</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>            <span class="op">/</span> scan_gc_constraints.loc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].Os_dif</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>    ).median()</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Starch median % of osmolarity: </span><span class="sc">{</span>starch_proportion<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    starch_proportion <span class="op">=</span> (</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>            scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].STARCH_p_gc_Linker_1</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">/</span> scan_gc_constraints.loc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].Os_dif</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>    ).mean()</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Starch mean % of osmolarity: </span><span class="sc">{</span>starch_proportion<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>    starch_proportion <span class="op">=</span> (</span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a>            scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].STARCH_p_gc_Linker_1</span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a>            <span class="op">/</span> scan_gc_constraints.loc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].Os_dif</span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">max</span>()</span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Starch max % of osmolarity: </span><span class="sc">{</span>starch_proportion<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a>    starch_proportion <span class="op">=</span> (</span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a>            scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].STARCH_p_gc_Linker_1</span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a>            <span class="op">/</span> scan_gc_constraints.loc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].Os_dif</span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">min</span>()</span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Starch min % of osmolarity: </span><span class="sc">{</span>starch_proportion<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ S.d. + G.i.:
Length: 1719 (90.9%)
Starch median % of osmolarity: 70.715257356063
Starch mean % of osmolarity: 70.75171038643512
Starch max % of osmolarity: 100.98969258230284
Starch min % of osmolarity: 33.70678055197705
+ S.d - G.i.:
Length: 48 (2.5%)
Starch median % of osmolarity: 42.479873042042186
Starch mean % of osmolarity: 40.49996318207206
Starch max % of osmolarity: 71.26373430673459
Starch min % of osmolarity: 19.421223452295543
- S.d + G.i.:
Length: 12 (0.6%)
Starch median % of osmolarity: 27.90927615890679
Starch mean % of osmolarity: 38.969721275346025
Starch max % of osmolarity: 89.30464909167985
Starch min % of osmolarity: 17.245084430356243
- S.d - G.i.:
Length: 113 (6.0%)
Starch median % of osmolarity: 23.38726473224462
Starch mean % of osmolarity: 26.19498288079809
Starch max % of osmolarity: 88.4285135863311
Starch min % of osmolarity: 0.010864363645033069</code></pre>
</div>
</div>
<div id="ff1c2358-854c-4a8b-8ec0-8b0e975ae208" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>glc_increase <span class="op">=</span> (</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>    scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>].GLC_total_pseudolinker_2</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>].GLC_total_pseudolinker_1</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>glc_increase_per_gc <span class="op">=</span> glc_increase <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">/</span> scan_constraints.N_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4eb05c95-f425-4a88-ab4e-07bde032708c" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> glucose_vs_starch_subfig(ax):</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">600</span>]</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">600</span>]</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y, c<span class="op">=</span><span class="st">"grey"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, clip_on<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>    conditions <span class="op">=</span> [</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>        sucrose_deg_and_glc_import,</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>        sucrose_deg_no_glc_import,</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>        no_sucrose_deg_glc_import,</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>        no_sucrose_deg_no_glc_import,</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    colours <span class="op">=</span> [</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>        sns.color_palette()[<span class="dv">2</span>],</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>        sns.color_palette()[<span class="dv">3</span>],</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>        sns.color_palette()[<span class="dv">4</span>],</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>        sns.color_palette()[<span class="dv">8</span>],</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"+ S.d. + G.i."</span>, <span class="st">"+ S.d - G.i."</span>, <span class="st">"- S.d + G.i."</span>, <span class="st">"- S.d - G.i."</span>]</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>    glucose_increase_max <span class="op">=</span> glc_increase_per_gc.<span class="bu">max</span>()</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> condition, colour, label <span class="kw">in</span> <span class="bu">zip</span>(conditions, colours, labels):</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>        ax.scatter(</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>            starch_per_gc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition],</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>            glc_increase_per_gc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition],</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>colour,</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>            s<span class="op">=</span>size,</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span>label,</span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>            linewidths<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>            clip_on<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Starch degradation</span><span class="ch">\n</span><span class="st">"</span> <span class="vs">r"(fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Increase in glucose (fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>    y_max <span class="op">=</span> glucose_increase_max</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>    x_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>    major_increment <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="va">None</span>, y_max)</span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="va">None</span>, x_max)</span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"left"</span>].set_bounds(<span class="dv">0</span>, y_max)</span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"bottom"</span>].set_bounds(<span class="dv">0</span>, x_max)</span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(major_increment))</span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(major_increment))</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">"equal"</span>)</span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.vlines(</span></span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a><span class="co">#         184, ymin=0, ymax=570, linewidth=1, linestyle="--", color=sns.color_palette()[6]</span></span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.text(</span></span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a><span class="co">#         184,</span></span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a><span class="co">#         570,</span></span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a><span class="co">#         "Horrer et al. (2016)",</span></span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a><span class="co">#         ha="center",</span></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a><span class="co">#         va="bottom",</span></span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a><span class="co">#         size="x-small",</span></span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a><span class="co">#         color=sns.color_palette()[6],</span></span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a>    ax.legend(</span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a>        loc<span class="op">=</span><span class="st">"lower right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">0</span>), handletextpad<span class="op">=</span><span class="dv">0</span>, fontsize<span class="op">=</span><span class="st">"x-small"</span></span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a>glucose_vs_starch_subfig(ax)</span>
<span id="cb131-75"><a href="#cb131-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-76"><a href="#cb131-76" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/starch_vs_glucose.svg"</span>)</span>
<span id="cb131-77"><a href="#cb131-77" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/starch_vs_glucose.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-86-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="c62935bf-94ec-4581-a188-225a5e52b175" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> glucose_vs_starch_subfig(ax):</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">600</span>]</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">600</span>]</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>    size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y, c<span class="op">=</span><span class="st">"grey"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, clip_on<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    conditions <span class="op">=</span> [</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>        sucrose_deg_and_glc_import,</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>        no_sucrose_deg_glc_import,</span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>        no_sucrose_deg_no_glc_import,</span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>        sucrose_deg_no_glc_import,</span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>    colours <span class="op">=</span> [</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>        sns.color_palette()[<span class="dv">2</span>],</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>        sns.color_palette()[<span class="dv">3</span>],</span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a>        sns.color_palette()[<span class="dv">4</span>],</span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>        sns.color_palette()[<span class="dv">8</span>],</span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"+ Suc deg + Glc import"</span>, <span class="st">"- Suc deg + Glc import"</span>, <span class="st">"- Suc deg - Glc import"</span>, <span class="st">"+ Suc deg - Glc import"</span>]</span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>    glucose_increase_max <span class="op">=</span> glc_increase_per_gc.<span class="bu">max</span>()</span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> condition, colour, label <span class="kw">in</span> <span class="bu">zip</span>(conditions, colours, labels):</span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a>        ax.scatter(</span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a>            starch_per_gc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition],</span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>            glc_increase_per_gc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition],</span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>colour,</span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>            s<span class="op">=</span>size,</span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a>            label<span class="op">=</span>label,</span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a>            linewidths<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a>            clip_on<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Starch degradation</span><span class="ch">\n</span><span class="st">"</span> <span class="vs">r"(fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Increase in glucose (fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">#y_max = glucose_increase_max</span></span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a>    y_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a>    x_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb132-42"><a href="#cb132-42" aria-hidden="true" tabindex="-1"></a>    major_increment <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb132-43"><a href="#cb132-43" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="va">None</span>, y_max)</span>
<span id="cb132-44"><a href="#cb132-44" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="va">None</span>, x_max)</span>
<span id="cb132-45"><a href="#cb132-45" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"left"</span>].set_bounds(<span class="dv">0</span>, y_max)</span>
<span id="cb132-46"><a href="#cb132-46" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"bottom"</span>].set_bounds(<span class="dv">0</span>, x_max)</span>
<span id="cb132-47"><a href="#cb132-47" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(major_increment))</span>
<span id="cb132-48"><a href="#cb132-48" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb132-49"><a href="#cb132-49" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(major_increment))</span>
<span id="cb132-50"><a href="#cb132-50" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb132-51"><a href="#cb132-51" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">"equal"</span>)</span>
<span id="cb132-52"><a href="#cb132-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-53"><a href="#cb132-53" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.vlines(</span></span>
<span id="cb132-54"><a href="#cb132-54" aria-hidden="true" tabindex="-1"></a><span class="co">#         184, ymin=0, ymax=570, linewidth=1, linestyle="--", color=sns.color_palette()[6]</span></span>
<span id="cb132-55"><a href="#cb132-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb132-56"><a href="#cb132-56" aria-hidden="true" tabindex="-1"></a><span class="co">#     ax.text(</span></span>
<span id="cb132-57"><a href="#cb132-57" aria-hidden="true" tabindex="-1"></a><span class="co">#         184,</span></span>
<span id="cb132-58"><a href="#cb132-58" aria-hidden="true" tabindex="-1"></a><span class="co">#         570,</span></span>
<span id="cb132-59"><a href="#cb132-59" aria-hidden="true" tabindex="-1"></a><span class="co">#         "Horrer et al. (2016)",</span></span>
<span id="cb132-60"><a href="#cb132-60" aria-hidden="true" tabindex="-1"></a><span class="co">#         ha="center",</span></span>
<span id="cb132-61"><a href="#cb132-61" aria-hidden="true" tabindex="-1"></a><span class="co">#         va="bottom",</span></span>
<span id="cb132-62"><a href="#cb132-62" aria-hidden="true" tabindex="-1"></a><span class="co">#         size="x-small",</span></span>
<span id="cb132-63"><a href="#cb132-63" aria-hidden="true" tabindex="-1"></a><span class="co">#         color=sns.color_palette()[6],</span></span>
<span id="cb132-64"><a href="#cb132-64" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb132-65"><a href="#cb132-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-66"><a href="#cb132-66" aria-hidden="true" tabindex="-1"></a>    ax.legend(</span>
<span id="cb132-67"><a href="#cb132-67" aria-hidden="true" tabindex="-1"></a>        loc<span class="op">=</span><span class="st">"lower right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">0</span>), handletextpad<span class="op">=</span><span class="dv">0</span>, fontsize<span class="op">=</span><span class="st">'x-small'</span></span>
<span id="cb132-68"><a href="#cb132-68" aria-hidden="true" tabindex="-1"></a>        <span class="co">#prop={'family': 'DejaVu Sans Mono', 'size': 'x-small'},</span></span>
<span id="cb132-69"><a href="#cb132-69" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb132-70"><a href="#cb132-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-71"><a href="#cb132-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb132-72"><a href="#cb132-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-73"><a href="#cb132-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-74"><a href="#cb132-74" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb132-75"><a href="#cb132-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-76"><a href="#cb132-76" aria-hidden="true" tabindex="-1"></a>glucose_vs_starch_subfig(ax)</span>
<span id="cb132-77"><a href="#cb132-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-78"><a href="#cb132-78" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/starch_vs_glucose.svg"</span>)</span>
<span id="cb132-79"><a href="#cb132-79" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/starch_vs_glucose.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-87-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combine-subfigures" class="level2">
<h2 class="anchored" data-anchor-id="combine-subfigures">Combine subfigures</h2>
<div id="67a91868-c112-4b94-84a3-9e0d02885e52" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.5</span>, wspace<span class="op">=</span><span class="fl">0.35</span>)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>phloemoutput_subfig(axs[<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>photons_vs_carbon_export_subfig(axs[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>starch_vs_os_subfig(axs[<span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>glucose_vs_starch_subfig(axs[<span class="dv">1</span>][<span class="dv">1</span>])</span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>][<span class="dv">1</span>].get_legend().remove()</span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, letter <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a>    [axs[<span class="dv">0</span>][<span class="dv">0</span>], axs[<span class="dv">0</span>][<span class="dv">1</span>], axs[<span class="dv">1</span>][<span class="dv">0</span>], axs[<span class="dv">1</span>][<span class="dv">1</span>]], [<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>]</span>
<span id="cb133-16"><a href="#cb133-16" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb133-17"><a href="#cb133-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> letter <span class="op">!=</span> <span class="st">"D"</span>:</span>
<span id="cb133-18"><a href="#cb133-18" aria-hidden="true" tabindex="-1"></a>        ax.text(<span class="op">-</span><span class="fl">0.4</span>, <span class="fl">1.06</span>, letter, transform<span class="op">=</span>ax.transAxes, size<span class="op">=</span><span class="dv">20</span>, weight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb133-19"><a href="#cb133-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb133-20"><a href="#cb133-20" aria-hidden="true" tabindex="-1"></a>        ax.text(<span class="op">-</span><span class="fl">0.333</span>, <span class="fl">1.06</span>, letter, transform<span class="op">=</span>ax.transAxes, size<span class="op">=</span><span class="dv">20</span>, weight<span class="op">=</span><span class="st">"bold"</span>)</span>
<span id="cb133-21"><a href="#cb133-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-22"><a href="#cb133-22" aria-hidden="true" tabindex="-1"></a>fig.savefig(</span>
<span id="cb133-23"><a href="#cb133-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../outputs/constraint_scan/constraint_scan_analysis_plot.svg"</span>, transparent<span class="op">=</span><span class="va">True</span></span>
<span id="cb133-24"><a href="#cb133-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb133-25"><a href="#cb133-25" aria-hidden="true" tabindex="-1"></a>fig.savefig(</span>
<span id="cb133-26"><a href="#cb133-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../outputs/constraint_scan/constraint_scan_analysis_plot.png"</span>, transparent<span class="op">=</span><span class="va">True</span></span>
<span id="cb133-27"><a href="#cb133-27" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-88-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="extra-analyses-not-included" class="level2">
<h2 class="anchored" data-anchor-id="extra-analyses-not-included">Extra analyses not included</h2>
<section id="what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase">What is the ratio of mitochondrial to plastidic ATP synthase?</h3>
<div id="deccef54-12cd-45ce-b420-332cb8edb863" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].hist(</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    scan_results.Plastidial_ATP_Synthase_p_gc_2[scan_constraints.light <span class="op">==</span> <span class="st">"white"</span>]</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> scan_results.Mitochondrial_ATP_Synthase_m_gc_2[scan_constraints.light <span class="op">==</span> <span class="st">"white"</span>],</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Opening in white light"</span>)</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">"Plastidial ATP Synthase</span><span class="ch">\n</span><span class="st">Mitochondrial ATP Synthase"</span>)</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].hist(</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>    scan_results.Plastidial_ATP_Synthase_p_gc_3</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> scan_results.Mitochondrial_ATP_Synthase_m_gc_3,</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    bins<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Day in both light types"</span>)</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">"Plastidial ATP Synthase</span><span class="ch">\n</span><span class="st">Mitochondrial ATP Synthase"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>Text(0.5, 0, 'Plastidial ATP Synthase\nMitochondrial ATP Synthase')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-89-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="1d991ce0-ac1f-478b-a2f6-72aa624a9e60" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>))</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>plastidial_atp_max <span class="op">=</span> scan_results.loc[</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    :, [<span class="st">"Plastidial_ATP_Synthase_p_gc_3"</span>, <span class="st">"Plastidial_ATP_Synthase_p_gc_2"</span>]</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>].<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>mitochondial_atp_max <span class="op">=</span> scan_results.loc[</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>    :, [<span class="st">"Mitochondrial_ATP_Synthase_m_gc_3"</span>, <span class="st">"Mitochondrial_ATP_Synthase_m_gc_2"</span>]</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>].<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"blue"</span>, <span class="st">"white"</span>]:</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>    ax.hist(</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>        plastidial_atp_max[scan_constraints.light <span class="op">==</span> light]</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">/</span> mitochondial_atp_max[scan_constraints.light <span class="op">==</span> light],</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>        histtype<span class="op">=</span><span class="st">"step"</span>,</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a>        label<span class="op">=</span>light,</span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Max plastidial ATP Synthase</span><span class="ch">\n</span><span class="st">Max mitochondrial ATP Synthase"</span>)</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>ax.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-90-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="ecd6ca9e-83ca-4982-ba39-db0cc1eb6dbd" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">0</span>, <span class="fl">0.3</span>], [<span class="dv">0</span>, <span class="fl">0.3</span>], c<span class="op">=</span><span class="st">"grey"</span>, zorder<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>ax.scatter(plastidial_atp_max, mitochondial_atp_max, s<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-91-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="2ac6d423-c882-4920-a681-e593274e1dee" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>(plastidial_atp_max <span class="op">/</span> mitochondial_atp_max).<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>0.016260605303926066</code></pre>
</div>
</div>
</section>
</section>
<section id="almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs" class="level2">
<h2 class="anchored" data-anchor-id="almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs">Almost all starch is used for glucose, and PEP carboxykinase reaction never runs</h2>
<div id="172a1cca-c009-4720-bdfd-1f8718bb5a0e" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>(scan_results.PEPCARBOX_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>77</code></pre>
</div>
</div>
<div id="951eb7a1-2fb8-486b-b6b3-9fcfb18f2683" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>(scan_results.PEPDEPHOS_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>1237</code></pre>
</div>
</div>
<div id="ac789d2c-b2dd-4d5a-9a3b-d5b0286f757e" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>((scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.PEPDEPHOS_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>1227</code></pre>
</div>
</div>
<div id="055eb3e7-2a39-4b47-a71a-091560829a5b" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>((scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.PYRUVDEH_RXN_m_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>1227</code></pre>
</div>
</div>
<div id="0a5bbb96-299a-4e38-b662-829d6444b01f" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>    (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">&amp;</span> (scan_results.ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>1266</code></pre>
</div>
</div>
<div id="ac79be72-e9ac-4e80-b9fd-0ff4dc7d5d9b" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>    scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].MALTODEG_RXN_c_gc_2 <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].PEPDEPHOS_RXN_c_gc_2</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>).hist(bins<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-98-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="9e86a684-ed64-43b1-8a92-503068e05ed9" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>    scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].MALTODEG_RXN_c_gc_2 <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].PYRUVDEH_RXN_m_gc_2</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>).hist(bins<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-99-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="1437177e-1d47-4181-acdc-acf6b30e7a7a" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>    scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].MALTODEG_RXN_c_gc_2</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span> scan_results[</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>        (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>    ].ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc_2</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>0       0.001622
1       0.005446
3       0.001043
4       0.001028
6       0.006612
          ...   
1931    0.003674
1932    0.002604
1933    0.007325
1934    0.002005
1935    0.005452
Length: 1266, dtype: float64</code></pre>
</div>
</div>
<div id="9b67f4c2-a583-4e6c-913e-fdf86eeb614f" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>(scan_results.MAL_total_pseudolinker_2 <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>433</code></pre>
</div>
</div>
<div id="5c940b87-4ccb-4bff-8add-d81f47ee2af5" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>scan_constraints[</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>        (scan_results.MAL_total_pseudolinker_2 <span class="op">-</span> scan_results.MAL_total_pseudolinker_1)</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">P_abs</th>
<th data-quarto-table-cell-role="th">T_l</th>
<th data-quarto-table-cell-role="th">A_l</th>
<th data-quarto-table-cell-role="th">V_gc_ind</th>
<th data-quarto-table-cell-role="th">FqFm</th>
<th data-quarto-table-cell-role="th">R_ch</th>
<th data-quarto-table-cell-role="th">R_ch_vol</th>
<th data-quarto-table-cell-role="th">L_air</th>
<th data-quarto-table-cell-role="th">L_epidermis</th>
<th data-quarto-table-cell-role="th">Vac_frac</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">N_gcs</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">m</th>
<th data-quarto-table-cell-role="th">r</th>
<th data-quarto-table-cell-role="th">s</th>
<th data-quarto-table-cell-role="th">C_apo</th>
<th data-quarto-table-cell-role="th">A_closed</th>
<th data-quarto-table-cell-role="th">A_open</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">light</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>0.923180</td>
<td>0.000190</td>
<td>1.0</td>
<td>1.250880e-12</td>
<td>0.889162</td>
<td>0.093534</td>
<td>0.195869</td>
<td>0.337197</td>
<td>0.196606</td>
<td>0.837767</td>
<td>...</td>
<td>1.064044e+09</td>
<td>2.025073</td>
<td>0.946228</td>
<td>5.400144e-14</td>
<td>1.664063e-13</td>
<td>0.023524</td>
<td>2.500598</td>
<td>9.754649</td>
<td>0.549826</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">6</td>
<td>0.912552</td>
<td>0.000236</td>
<td>1.0</td>
<td>2.797833e-12</td>
<td>0.791717</td>
<td>0.122612</td>
<td>0.211564</td>
<td>0.203218</td>
<td>0.121087</td>
<td>0.788955</td>
<td>...</td>
<td>8.580407e+08</td>
<td>1.718809</td>
<td>0.985739</td>
<td>6.484944e-14</td>
<td>2.811758e-13</td>
<td>0.028334</td>
<td>1.156307</td>
<td>11.339261</td>
<td>2.620532</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>0.811951</td>
<td>0.000203</td>
<td>1.0</td>
<td>1.725438e-12</td>
<td>0.862305</td>
<td>0.134778</td>
<td>0.202345</td>
<td>0.342059</td>
<td>0.149051</td>
<td>0.886573</td>
<td>...</td>
<td>5.641395e+08</td>
<td>2.345712</td>
<td>0.922066</td>
<td>7.661761e-14</td>
<td>1.713217e-13</td>
<td>0.024734</td>
<td>3.836327</td>
<td>11.685743</td>
<td>0.807819</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>0.868580</td>
<td>0.000235</td>
<td>1.0</td>
<td>2.230336e-12</td>
<td>0.813387</td>
<td>0.143595</td>
<td>0.210389</td>
<td>0.231901</td>
<td>0.233709</td>
<td>0.788520</td>
<td>...</td>
<td>8.827028e+08</td>
<td>1.563814</td>
<td>0.955703</td>
<td>5.755866e-14</td>
<td>2.976694e-13</td>
<td>0.032311</td>
<td>2.576765</td>
<td>10.693166</td>
<td>4.401374</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">28</td>
<td>0.905738</td>
<td>0.000226</td>
<td>1.0</td>
<td>2.077161e-12</td>
<td>0.858599</td>
<td>0.065746</td>
<td>0.199877</td>
<td>0.232093</td>
<td>0.200455</td>
<td>0.892994</td>
<td>...</td>
<td>1.832267e+08</td>
<td>2.259343</td>
<td>0.879945</td>
<td>6.486503e-14</td>
<td>1.705626e-13</td>
<td>0.027999</td>
<td>2.573815</td>
<td>6.189742</td>
<td>0.199106</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1929</td>
<td>0.963328</td>
<td>0.000213</td>
<td>1.0</td>
<td>3.549447e-12</td>
<td>0.822882</td>
<td>0.088125</td>
<td>0.207902</td>
<td>0.284514</td>
<td>0.172490</td>
<td>0.882110</td>
<td>...</td>
<td>3.941232e+08</td>
<td>1.836419</td>
<td>0.800060</td>
<td>7.761785e-14</td>
<td>1.283119e-13</td>
<td>0.025384</td>
<td>3.250332</td>
<td>8.157482</td>
<td>5.580050</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1930</td>
<td>0.878002</td>
<td>0.000222</td>
<td>1.0</td>
<td>2.235053e-12</td>
<td>0.861774</td>
<td>0.132702</td>
<td>0.209615</td>
<td>0.209708</td>
<td>0.145820</td>
<td>0.865507</td>
<td>...</td>
<td>3.784323e+08</td>
<td>2.348202</td>
<td>0.814245</td>
<td>5.768938e-14</td>
<td>2.320267e-13</td>
<td>0.030561</td>
<td>2.664441</td>
<td>11.247607</td>
<td>3.675367</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1932</td>
<td>0.957473</td>
<td>0.000185</td>
<td>1.0</td>
<td>2.755496e-12</td>
<td>0.798181</td>
<td>0.097823</td>
<td>0.201847</td>
<td>0.193194</td>
<td>0.138359</td>
<td>0.823731</td>
<td>...</td>
<td>6.623405e+08</td>
<td>1.889247</td>
<td>0.969003</td>
<td>6.787495e-14</td>
<td>1.566538e-13</td>
<td>0.032169</td>
<td>1.321999</td>
<td>5.766979</td>
<td>2.750124</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1933</td>
<td>0.816118</td>
<td>0.000174</td>
<td>1.0</td>
<td>2.957736e-12</td>
<td>0.825422</td>
<td>0.149150</td>
<td>0.200244</td>
<td>0.323872</td>
<td>0.209562</td>
<td>0.830375</td>
<td>...</td>
<td>9.035571e+08</td>
<td>1.971395</td>
<td>0.971101</td>
<td>7.917051e-14</td>
<td>2.960270e-13</td>
<td>0.031594</td>
<td>1.293918</td>
<td>7.247967</td>
<td>1.492903</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1935</td>
<td>0.953724</td>
<td>0.000240</td>
<td>1.0</td>
<td>1.884973e-12</td>
<td>0.894087</td>
<td>0.135577</td>
<td>0.189014</td>
<td>0.241198</td>
<td>0.137301</td>
<td>0.844829</td>
<td>...</td>
<td>5.504971e+08</td>
<td>1.561648</td>
<td>0.977668</td>
<td>6.731378e-14</td>
<td>2.085531e-13</td>
<td>0.036108</td>
<td>2.326208</td>
<td>9.325369</td>
<td>4.832752</td>
<td>blue</td>
</tr>
</tbody>
</table>

<p>375 rows × 22 columns</p>
</div>
</div>
</div>
<div id="6226dd00-0372-4237-9370-c92395159734" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#starch[1384]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8c48aa5c-6f4e-49eb-9796-b440d6cb4828" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(scan_constraints.loc[1384] - scan_constraints.mean()) / scan_constraints.std()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fb5b2593-31a5-4550-b2c7-2333b4668927" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scan_constraints.loc[1384].ATPase</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7e6de9c5-e45a-4f9e-8760-2fdd8ac6e549" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>scan_constraints.mean().ATPase</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_8731/856568451.py:1: FutureWarning: The default value of numeric_only in DataFrame.mean is deprecated. In a future version, it will default to False. In addition, specifying 'numeric_only=None' is deprecated. Select only valid columns or specify the value of numeric_only to silence this warning.
  scan_constraints.mean().ATPase</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>8.53114718372621</code></pre>
</div>
</div>
<div id="0507eec0-c6d0-4b37-8801-4a993e4c96e6" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#atpase_constrained[1384]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="254a538e-0d1b-4c85-a0ed-9d41041b43a2" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scan_results.loc[1384].MALTODEG_RXN_c_gc_2 / starch[1384] * 100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ddf1c937-0eb3-43ac-a675-7f36700a250f" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scan_results.loc[1384].RXN_2141_p_gc_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6bf60174-9b77-4cf1-bf97-e601d1eda459" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scan_results.loc[1384].MALATE_DEH_RXN_m_gc_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="00c65a11-59f4-4821-9275-54c840a8f60b" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#scan_results.loc[1384].ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2741deaf-7ef4-4f21-ab49-68336dc731d8" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(scan_gc_constraints.loc[1384] - scan_gc_constraints.mean()) / scan_gc_constraints.std()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="087d6485-a16c-4ce9-8efc-550814f89fa7" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [i<span class="op">+</span><span class="dv">1</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)]:</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>    reaction <span class="op">=</span> <span class="ss">f"PALMITATE_c_gc_Linker_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(reaction)</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(scan_results.loc[:, reaction].<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PALMITATE_c_gc_Linker_1
0.0
PALMITATE_c_gc_Linker_2
0.0
PALMITATE_c_gc_Linker_3
0.0
PALMITATE_c_gc_Linker_4
0.0</code></pre>
</div>
</div>
<div id="ca36ce1a" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>scan_results.<span class="bu">filter</span>(like<span class="op">=</span><span class="st">"ATPase"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PROTON_ATPase_c_me_1</th>
<th data-quarto-table-cell-role="th">PROTON_ATPase_c_me_2</th>
<th data-quarto-table-cell-role="th">PROTON_ATPase_c_me_3</th>
<th data-quarto-table-cell-role="th">PROTON_ATPase_c_me_4</th>
<th data-quarto-table-cell-role="th">PROTON_ATPase_c_gc_1</th>
<th data-quarto-table-cell-role="th">PROTON_ATPase_c_gc_2</th>
<th data-quarto-table-cell-role="th">PROTON_ATPase_c_gc_3</th>
<th data-quarto-table-cell-role="th">PROTON_ATPase_c_gc_4</th>
<th data-quarto-table-cell-role="th">ATPase_tx_me_1</th>
<th data-quarto-table-cell-role="th">ATPase_tx_me_2</th>
<th data-quarto-table-cell-role="th">ATPase_tx_me_3</th>
<th data-quarto-table-cell-role="th">ATPase_tx_me_4</th>
<th data-quarto-table-cell-role="th">ATPase_tx_gc_1</th>
<th data-quarto-table-cell-role="th">ATPase_tx_gc_2</th>
<th data-quarto-table-cell-role="th">ATPase_tx_gc_3</th>
<th data-quarto-table-cell-role="th">ATPase_tx_gc_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.107532</td>
<td>3.646232</td>
<td>3.763789</td>
<td>1.104726</td>
<td>0.000025</td>
<td>0.004851</td>
<td>0.004851</td>
<td>0.000025</td>
<td>10.025916</td>
<td>12.182122</td>
<td>12.182122</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000973</td>
<td>0.000973</td>
<td>0.000444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1.271757</td>
<td>4.186898</td>
<td>4.311376</td>
<td>1.268535</td>
<td>0.000057</td>
<td>0.000585</td>
<td>0.000585</td>
<td>0.000057</td>
<td>10.025916</td>
<td>12.468127</td>
<td>12.468127</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000967</td>
<td>0.000967</td>
<td>0.000444</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1.131079</td>
<td>3.723755</td>
<td>3.832643</td>
<td>1.128600</td>
<td>0.000000</td>
<td>0.004505</td>
<td>0.000000</td>
<td>0.000000</td>
<td>10.025916</td>
<td>12.223283</td>
<td>12.223283</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000598</td>
<td>0.000598</td>
<td>0.000444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1.207758</td>
<td>3.976199</td>
<td>4.097909</td>
<td>1.204698</td>
<td>0.000583</td>
<td>0.004855</td>
<td>0.002277</td>
<td>0.000583</td>
<td>10.025916</td>
<td>12.356973</td>
<td>12.356973</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000508</td>
<td>0.000508</td>
<td>0.000444</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1.260299</td>
<td>4.149174</td>
<td>4.286096</td>
<td>1.257106</td>
<td>0.000025</td>
<td>0.011479</td>
<td>0.007823</td>
<td>0.000025</td>
<td>10.025916</td>
<td>12.448415</td>
<td>12.448415</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000614</td>
<td>0.000614</td>
<td>0.000444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1931</td>
<td>1.105102</td>
<td>3.315307</td>
<td>3.773362</td>
<td>1.102419</td>
<td>0.000025</td>
<td>0.006605</td>
<td>0.006605</td>
<td>0.000025</td>
<td>10.025916</td>
<td>10.025916</td>
<td>12.273932</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000444</td>
<td>0.001019</td>
<td>0.000444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1932</td>
<td>1.261907</td>
<td>3.785721</td>
<td>4.297397</td>
<td>1.258843</td>
<td>0.000057</td>
<td>0.001822</td>
<td>0.001822</td>
<td>0.000057</td>
<td>10.025916</td>
<td>10.025916</td>
<td>12.558822</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000444</td>
<td>0.001011</td>
<td>0.000444</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1933</td>
<td>1.056017</td>
<td>3.168052</td>
<td>3.599472</td>
<td>1.053454</td>
<td>0.000057</td>
<td>0.001349</td>
<td>0.001349</td>
<td>0.000057</td>
<td>10.025916</td>
<td>10.025916</td>
<td>12.183832</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000444</td>
<td>0.001976</td>
<td>0.000444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1934</td>
<td>1.228512</td>
<td>3.685537</td>
<td>4.184889</td>
<td>1.225530</td>
<td>0.000025</td>
<td>0.003092</td>
<td>0.003092</td>
<td>0.000215</td>
<td>10.025916</td>
<td>10.025916</td>
<td>12.498539</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000444</td>
<td>0.000641</td>
<td>0.000444</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1935</td>
<td>1.256399</td>
<td>3.769198</td>
<td>4.279254</td>
<td>1.253349</td>
<td>0.000057</td>
<td>0.002660</td>
<td>0.002660</td>
<td>0.000057</td>
<td>10.025916</td>
<td>10.025916</td>
<td>12.549088</td>
<td>10.025916</td>
<td>0.000444</td>
<td>0.000444</td>
<td>0.000826</td>
<td>0.000444</td>
</tr>
</tbody>
</table>

<p>1934 rows × 16 columns</p>
</div>
</div>
</div>
<div id="a671fb4e" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>scan_constraints</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">P_abs</th>
<th data-quarto-table-cell-role="th">T_l</th>
<th data-quarto-table-cell-role="th">A_l</th>
<th data-quarto-table-cell-role="th">V_gc_ind</th>
<th data-quarto-table-cell-role="th">FqFm</th>
<th data-quarto-table-cell-role="th">R_ch</th>
<th data-quarto-table-cell-role="th">R_ch_vol</th>
<th data-quarto-table-cell-role="th">L_air</th>
<th data-quarto-table-cell-role="th">L_epidermis</th>
<th data-quarto-table-cell-role="th">Vac_frac</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">N_gcs</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">m</th>
<th data-quarto-table-cell-role="th">r</th>
<th data-quarto-table-cell-role="th">s</th>
<th data-quarto-table-cell-role="th">C_apo</th>
<th data-quarto-table-cell-role="th">A_closed</th>
<th data-quarto-table-cell-role="th">A_open</th>
<th data-quarto-table-cell-role="th">ATPase</th>
<th data-quarto-table-cell-role="th">light</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.815093</td>
<td>0.000194</td>
<td>1.0</td>
<td>2.262641e-12</td>
<td>0.809297</td>
<td>0.179970</td>
<td>0.191527</td>
<td>0.240879</td>
<td>0.214860</td>
<td>0.858645</td>
<td>...</td>
<td>4.484392e+08</td>
<td>1.933548</td>
<td>0.992641</td>
<td>7.886553e-14</td>
<td>1.678654e-13</td>
<td>0.033679</td>
<td>2.321339</td>
<td>11.318979</td>
<td>10.816668</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.923180</td>
<td>0.000190</td>
<td>1.0</td>
<td>1.250880e-12</td>
<td>0.889162</td>
<td>0.093534</td>
<td>0.195869</td>
<td>0.337197</td>
<td>0.196606</td>
<td>0.837767</td>
<td>...</td>
<td>1.064044e+09</td>
<td>2.025073</td>
<td>0.946228</td>
<td>5.400144e-14</td>
<td>1.664063e-13</td>
<td>0.023524</td>
<td>2.500598</td>
<td>9.754649</td>
<td>0.549826</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.830507</td>
<td>0.000220</td>
<td>1.0</td>
<td>5.035745e-13</td>
<td>0.821060</td>
<td>0.167889</td>
<td>0.204824</td>
<td>0.331556</td>
<td>0.205674</td>
<td>0.816618</td>
<td>...</td>
<td>5.758277e+08</td>
<td>2.141889</td>
<td>0.972835</td>
<td>6.579620e-14</td>
<td>2.457118e-13</td>
<td>0.034062</td>
<td>2.802180</td>
<td>3.338120</td>
<td>7.823891</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.880998</td>
<td>0.000192</td>
<td>1.0</td>
<td>8.629192e-13</td>
<td>0.866582</td>
<td>0.051244</td>
<td>0.204472</td>
<td>0.309538</td>
<td>0.169957</td>
<td>0.813726</td>
<td>...</td>
<td>3.851195e+08</td>
<td>2.077401</td>
<td>0.940848</td>
<td>5.747590e-14</td>
<td>1.515328e-13</td>
<td>0.029770</td>
<td>3.399462</td>
<td>9.936390</td>
<td>12.606738</td>
<td>white</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.915597</td>
<td>0.000220</td>
<td>1.0</td>
<td>7.391447e-13</td>
<td>0.846358</td>
<td>0.059969</td>
<td>0.193449</td>
<td>0.352066</td>
<td>0.238671</td>
<td>0.810491</td>
<td>...</td>
<td>1.046353e+09</td>
<td>2.396012</td>
<td>0.817798</td>
<td>7.654181e-14</td>
<td>1.652973e-13</td>
<td>0.028420</td>
<td>3.305233</td>
<td>7.650706</td>
<td>10.970481</td>
<td>white</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1931</td>
<td>0.849808</td>
<td>0.000174</td>
<td>1.0</td>
<td>2.640313e-12</td>
<td>0.880585</td>
<td>0.134355</td>
<td>0.193583</td>
<td>0.289995</td>
<td>0.213762</td>
<td>0.794641</td>
<td>...</td>
<td>4.117855e+08</td>
<td>1.711337</td>
<td>0.981658</td>
<td>6.898412e-14</td>
<td>1.062431e-13</td>
<td>0.033170</td>
<td>1.843784</td>
<td>11.521533</td>
<td>16.039577</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1932</td>
<td>0.957473</td>
<td>0.000185</td>
<td>1.0</td>
<td>2.755496e-12</td>
<td>0.798181</td>
<td>0.097823</td>
<td>0.201847</td>
<td>0.193194</td>
<td>0.138359</td>
<td>0.823731</td>
<td>...</td>
<td>6.623405e+08</td>
<td>1.889247</td>
<td>0.969003</td>
<td>6.787495e-14</td>
<td>1.566538e-13</td>
<td>0.032169</td>
<td>1.321999</td>
<td>5.766979</td>
<td>2.750124</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1933</td>
<td>0.816118</td>
<td>0.000174</td>
<td>1.0</td>
<td>2.957736e-12</td>
<td>0.825422</td>
<td>0.149150</td>
<td>0.200244</td>
<td>0.323872</td>
<td>0.209562</td>
<td>0.830375</td>
<td>...</td>
<td>9.035571e+08</td>
<td>1.971395</td>
<td>0.971101</td>
<td>7.917051e-14</td>
<td>2.960270e-13</td>
<td>0.031594</td>
<td>1.293918</td>
<td>7.247967</td>
<td>1.492903</td>
<td>blue</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1934</td>
<td>0.934550</td>
<td>0.000234</td>
<td>1.0</td>
<td>1.122269e-12</td>
<td>0.799613</td>
<td>0.047919</td>
<td>0.202674</td>
<td>0.351210</td>
<td>0.192651</td>
<td>0.814861</td>
<td>...</td>
<td>1.121745e+09</td>
<td>2.313188</td>
<td>0.857276</td>
<td>6.322405e-14</td>
<td>1.450759e-13</td>
<td>0.023108</td>
<td>2.345988</td>
<td>6.138390</td>
<td>2.756515</td>
<td>blue</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1935</td>
<td>0.953724</td>
<td>0.000240</td>
<td>1.0</td>
<td>1.884973e-12</td>
<td>0.894087</td>
<td>0.135577</td>
<td>0.189014</td>
<td>0.241198</td>
<td>0.137301</td>
<td>0.844829</td>
<td>...</td>
<td>5.504971e+08</td>
<td>1.561648</td>
<td>0.977668</td>
<td>6.731378e-14</td>
<td>2.085531e-13</td>
<td>0.036108</td>
<td>2.326208</td>
<td>9.325369</td>
<td>4.832752</td>
<td>blue</td>
</tr>
</tbody>
</table>

<p>1934 rows × 22 columns</p>
</div>
</div>
</div>
<div id="324f5cc1" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">min</span>(scan_constraints.P_abs))</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">min</span>(scan_results.Phloem_tx_overall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8101673308967071
12.675979574938289</code></pre>
</div>
</div>
<div id="f4aae728" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">max</span>(scan_constraints.R_ch_vol))</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">min</span>(scan_constraints.R_ch_vol))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.2128525606703812
0.1889727321710271</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/noahsprent\.github\.io\/mmon-gcm");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./3.2_run_constraint_scan.html" class="pagination-link" aria-label="Running Constraint Scan">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Running Constraint Scan</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./functions/alternativemodes.html" class="pagination-link" aria-label="alternativemodes">
        <span class="nav-page-text">alternativemodes</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/noahsprent/mmon-gcm/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>